(()=>{"use strict";const e=(()=>{const e=[],t=t=>{let n=e.find((e=>e.getName()===t));return n||(n=(e=>{let t=e,n=[];return{getName:()=>t,addHandler:e=>{n.push(e)},invokeHandlers:e=>{n.forEach((t=>{t(e)}))}}})(t),e.push(n)),n};return{publish:(e,n)=>{t(e).invokeHandlers(n)},subscribe:(e,n)=>{t(e).addHandler(n)}}})(),t=(()=>{const t=(e,t=null,n=null)=>{const i=document.createElement(e);return t&&t.forEach((e=>i.classList.add(e))),n&&(i.textContent=n),i},n=e=>e.classList.value.split(" ")[0],i=document.querySelector(".category-container"),d=document.querySelector(".add-category");let r=null;const s=t=>{r&&r.classList.remove("active"),t.classList.add("active"),r=t,e.publish("categoryActive",n(t))},a=e=>{const d=(e=>{const n=t("div",[e.getName(),"category"]);return n.appendChild(t("div",["text"],e.getName())),0!=i.childElementCount&&n.appendChild(t("div",["delete","btn"],"x")),n})(e);i.appendChild(d),(e=>{n(e);const t=e.lastChild;t.addEventListener("click",(e=>{e.stopPropagation(),o(t.parentNode)})),e.addEventListener("click",(()=>{s(e)}))})(d),s(d)},o=t=>{t==r&&s(i.firstElementChild),t.remove(),e.publish("removeCategory",n(t))},c=document.querySelector(".item-container"),l=document.querySelector(".add-item"),m=e=>{for(;c.childElementCount>0;)c.lastChild.remove();e.map((e=>u(e)))},u=e=>{const n=(e=>{const n=t("div",["item"]),i=document.createElement("input");return i.type="checkbox",n.appendChild(i),n.appendChild(t("div",["text"],e.content)),n.appendChild(t("div",["delete","btn"],"x")),n})(e);c.appendChild(n),(e=>{const t=Array.from(e.children),n=t.find((e=>e.classList.contains("text"))).textContent,i=t.find((e=>e.classList.contains("delete")));i.addEventListener("click",(()=>{p(i.parentNode,n)}))})(n)},p=(t,i)=>{t.remove(),e.publish("removeItem",{activeCategoryName:n(r),itemContent:i})};return{init:()=>{d.addEventListener("click",(()=>{e.publish("addCategory",prompt("Enter"))})),e.subscribe("categoryAdded",a),l.addEventListener("click",(()=>{const t=r.firstChild.textContent,n=prompt("Enter");e.publish("addItem",{activeCategoryName:t,itemContent:n})})),e.subscribe("categoryItemsLoaded",m),e.subscribe("itemAdded",u),e.publish("addCategory","All"),e.publish("addCategory","Random"),e.publish("addCategory","Categories"),s(i.firstElementChild)},setActive:s}})(),n=t;(()=>{const t=[],n=e=>t.find((t=>t.getName()===e)),i=i=>{if(n(i))return void alert("This category already exists!");const d=(e=>{let t=e,n=[];return{getName:()=>t,addItem:e=>{const t={isDone:!1,content:e};return n.push(t),t},removeItem:e=>{const t=n.find((t=>t.content===e)),i=n.indexOf(t);n.splice(i,1)},getItems:()=>n}})(i);t.push(d),e.publish("categoryAdded",d)},d=e=>{const i=t.indexOf(n(e));t.splice(i,1)},r=t=>{const i=n(t).getItems();e.publish("categoryItemsLoaded",i)},s=({activeCategoryName:i,itemContent:d})=>{const r=n(i),s=r.addItem(d);r!=t[0]&&t[0].addItem(d),e.publish("itemAdded",s)},a=({activeCategoryName:e,itemContent:t})=>{n(e).removeItem(t)};return{init:()=>{e.subscribe("addCategory",i),e.subscribe("removeCategory",d),e.subscribe("categoryActive",r),e.subscribe("addItem",s),e.subscribe("removeItem",a)}}})().init(),n.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQ0gwQixRQVlrQixFQVhsQmpFLFFBV3lCaUQsR0FFekIsT0FEQVosRUFBTWpELEtBQUttRCxHQUNKQSxHQWNQMkIsV0FYZ0JqQixJQUNoQixNQUFNVixFQUFPRixFQUFNdkQsTUFBS3lELEdBQVFBLEVBQUt2QyxVQUFZaUQsSUFDM0NrQixFQUFROUIsRUFBTStCLFFBQVE3QixHQUM1QkYsRUFBTWdDLE9BQU9GLEVBQU8sSUFTcEJHLFNBTmEsSUFBTWpDLElEUlAsQ0FBU3VCLEdBQ3JCRixFQUFXdEUsS0FBS3lFLEdBQ2hCLFVBQWUsZ0JBQWlCQSxJQUc5QlUsRUFBa0JYLElBQ3BCLE1BQU1PLEVBQVFULEVBQVdVLFFBQVFULEVBQVlDLElBQzdDRixFQUFXVyxPQUFPRixFQUFPLElBS3ZCRyxFQUFZVixJQUNkLE1BQU12QixFQUFRc0IsRUFBWUMsR0FBY1UsV0FDeEMsVUFBZSxzQkFBdUJqQyxJQUdwQzJCLEVBQVUsRUFBRVYsbUJBQUFBLEVBQW9CTCxZQUFBQSxNQUNsQyxNQUFNdUIsRUFBWWIsRUFBWUwsR0FDeEJmLEVBQU9pQyxFQUFVUixRQUFRZixHQUMzQnVCLEdBQWFkLEVBQVcsSUFBSUEsRUFBVyxHQUFHTSxRQUFRZixHQUN0RCxVQUFlLFlBQWFWLElBRzFCMkIsRUFBYSxFQUFFWixtQkFBQUEsRUFBb0JMLFlBQUFBLE1BQ3JDVSxFQUFZTCxHQUFvQlksV0FBV2pCLElBWS9DLE1BQU8sQ0FDSE0sS0FWUyxLQUNULFlBQWlCLGNBQWVPLEdBQ2hDLFlBQWlCLGlCQUFrQlMsR0FFbkMsWUFBaUIsaUJBQWtCRCxHQUNuQyxZQUFpQixVQUFXTixHQUM1QixZQUFpQixhQUFjRSxNQWpEWixHQXlEUlgsT0FDbkIsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG9pc3QvLi9zcmMvbW9kdWxlcy9wdWJzdWIuanMiLCJ3ZWJwYWNrOi8vdG9kb2lzdC8uL3NyYy9tb2R1bGVzL1VJLmpzIiwid2VicGFjazovL3RvZG9pc3QvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kb2lzdC8uL3NyYy9tb2R1bGVzL2NhdGVnb3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5FdmVudHMgOlxuXG5hZGRJdGVtXG5pdGVtQWRkZWRcblxuYWRkQ2F0ZWdvcnlcbnJlbW92ZUNhdGVnb3J5XG5jYXRlZ29yeUFkZGVkXG5jYXRlZ29yeVJlbW92ZWRcblxuKi9cblxuXG5jb25zdCBfRXZlbnQgPSAoZXZlbnROYW1lKSA9PiB7XG4gICAgbGV0IG5hbWUgPSBldmVudE5hbWU7XG4gICAgbGV0IGhhbmRsZXJzID0gW107XG5cbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZTtcbiAgICBjb25zdCBhZGRIYW5kbGVyID0gKGhhbmRsZXIpID0+IHtcbiAgICAgICAgaGFuZGxlcnMucHVzaChoYW5kbGVyKTtcbiAgICB9ICAgXG4gICAgY29uc3QgaW52b2tlSGFuZGxlcnMgPSAoZXZlbnRBcmdzKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgZm4oZXZlbnRBcmdzKTtcbiAgICAgICAgfSlcbiAgICB9XG4gICAgIHJldHVybiB7IGdldE5hbWUsIGFkZEhhbmRsZXIsIGludm9rZUhhbmRsZXJzLH07XG59XG5cbmNvbnN0IFB1YlN1YiA9ICgoKSA9PiB7XG4gICAgY29uc3QgX2V2ZW50cyA9IFtdO1xuXG4gICAgY29uc3QgY2hlY2tFdmVudCAgPSAoZXZlbnROYW1lKSA9PiB7XG4gICAgICAgIGxldCBldmVudCA9IF9ldmVudHMuZmluZChldmVudCA9PiBldmVudC5nZXROYW1lKCkgPT09IGV2ZW50TmFtZSk7XG4gICAgICAgIGlmICghZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50ID0gX0V2ZW50KGV2ZW50TmFtZSk7XG4gICAgICAgICAgICBfZXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICB9XG5cbiAgICBjb25zdCBwdWJsaXNoID0gKGV2ZW50TmFtZSwgZXZlbnRBcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gY2hlY2tFdmVudChldmVudE5hbWUpO1xuICAgICAgICBldmVudC5pbnZva2VIYW5kbGVycyhldmVudEFyZ3MpO1xuICAgIH1cblxuICAgIGNvbnN0IHN1YnNjcmliZSA9IChldmVudE5hbWUsIGhhbmRsZXIpID0+IHtcbiAgICAgICAgY29uc3QgZXZlbnQgPSBjaGVja0V2ZW50KGV2ZW50TmFtZSk7XG4gICAgICAgIGV2ZW50LmFkZEhhbmRsZXIoaGFuZGxlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHVibGlzaCwgXG4gICAgICAgIHN1YnNjcmliZSxcbiAgICB9O1xuXG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBQdWJTdWI7IiwiaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi9wdWJzdWJcIjtcblxuY29uc3QgVUkgPSAoKCkgPT4ge1xuXG4gICAgLypcbiAgICBVdGlsXG4gICAgKi9cblxuICAgIGNvbnN0IGNyZWF0ZUh0bWxFbGVtZW50ID0gKHR5cGUsIGNsYXNzQXJyYXkgPSBudWxsLCBjb250ZW50ID0gbnVsbCkgPT4ge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcbiAgICAgICAgaWYgKGNsYXNzQXJyYXkpIGNsYXNzQXJyYXkuZm9yRWFjaChjbHMgPT4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNscykpO1xuICAgICAgICBpZiAoY29udGVudCkgZWxlbWVudC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH1cblxuICAgIGNvbnN0IGdldENhdGVnb3J5TmFtZSA9ICgkY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgcmV0dXJuICRjYXRlZ29yeS5jbGFzc0xpc3QudmFsdWUuc3BsaXQoJyAnKVswXTtcbiAgICB9XG5cbiAgICAvKlxuICAgIENhdGVnb3JpZXMgVUlcbiAgICAqL1xuXG4gICAgY29uc3QgJGNhdGVnb3J5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhdGVnb3J5LWNvbnRhaW5lcicpO1xuICAgIGNvbnN0ICRhZGRDYXRlZ29yeUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtY2F0ZWdvcnknKTtcbiAgICBsZXQgJGN1cnJlbnRBY3RpdmUgPSBudWxsO1xuXG4gICAgY29uc3QgbmV3Q2F0ZWdvcnkgPSAoY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgY29uc3QgJGNhdCA9IGNyZWF0ZUh0bWxFbGVtZW50KCdkaXYnLCBbY2F0ZWdvcnkuZ2V0TmFtZSgpLCAnY2F0ZWdvcnknXSk7XG4gICAgICAgICRjYXQuYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGV4dCddLCBjYXRlZ29yeS5nZXROYW1lKCkpKTtcbiAgICAgICAgaWYgKCRjYXRlZ29yeUNvbnRhaW5lci5jaGlsZEVsZW1lbnRDb3VudCAhPSAwKVxuICAgICAgICAgICAgJGNhdC5hcHBlbmRDaGlsZChjcmVhdGVIdG1sRWxlbWVudCgnZGl2JywgWydkZWxldGUnLCAnYnRuJ10sICd4JykpO1xuICAgICAgICByZXR1cm4gJGNhdDtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRDYXRlZ29yeUxpc3RlbmVyID0gKCRjYXRlZ29yeSkgPT4ge1xuICAgICAgICBjb25zdCBjYXRlZ29yeU5hbWUgPSBnZXRDYXRlZ29yeU5hbWUoJGNhdGVnb3J5KTtcbiAgICAgICAgY29uc3QgJGRlbGV0ZUJ0biA9ICRjYXRlZ29yeS5sYXN0Q2hpbGQ7XG5cbiAgICAgICAgJGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgcmVtb3ZlQ2F0ZWdvcnlET00oJGRlbGV0ZUJ0bi5wYXJlbnROb2RlKTtcbiAgICAgICAgfSlcblxuICAgICAgICAkY2F0ZWdvcnkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBzZXRBY3RpdmUoJGNhdGVnb3J5KTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCBzZXRBY3RpdmUgPSAoJGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIGlmICgkY3VycmVudEFjdGl2ZSkgJGN1cnJlbnRBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICAkY2F0ZWdvcnkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAkY3VycmVudEFjdGl2ZSA9ICRjYXRlZ29yeTtcbiAgICAgICAgXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdjYXRlZ29yeUFjdGl2ZScsIGdldENhdGVnb3J5TmFtZSgkY2F0ZWdvcnkpKTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRDYXRlZ29yeURPTSA9IChjYXRlZ29yeSkgPT4ge1xuICAgICAgICBjb25zdCAkbmV3Q2F0ZWdvcnkgPSBuZXdDYXRlZ29yeShjYXRlZ29yeSk7XG4gICAgICAgICRjYXRlZ29yeUNvbnRhaW5lci5hcHBlbmRDaGlsZCgkbmV3Q2F0ZWdvcnkpO1xuICAgICAgICBhZGRDYXRlZ29yeUxpc3RlbmVyKCRuZXdDYXRlZ29yeSk7XG4gICAgICAgIHNldEFjdGl2ZSgkbmV3Q2F0ZWdvcnkpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUNhdGVnb3J5RE9NID0gKCRjYXRlZ29yeSkgPT4ge1xuICAgICAgICBpZiAoJGNhdGVnb3J5ID09ICRjdXJyZW50QWN0aXZlKSBcbiAgICAgICAgICAgIHNldEFjdGl2ZSgkY2F0ZWdvcnlDb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQpO1xuICAgICAgICAkY2F0ZWdvcnkucmVtb3ZlKCk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdyZW1vdmVDYXRlZ29yeScsIGdldENhdGVnb3J5TmFtZSgkY2F0ZWdvcnkpKTtcbiAgICB9XG5cbiAgICAvKlxuICAgIEl0ZW1zIFVJXG4gICAgKi9cbiAgICBcbiAgICBjb25zdCAkaXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pdGVtLWNvbnRhaW5lcicpO1xuICAgIGNvbnN0ICRhZGRJdGVtQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1pdGVtJyk7XG5cbiAgICBjb25zdCBuZXdJdGVtRE9NID0gKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSBjcmVhdGVIdG1sRWxlbWVudCgnZGl2JywgWydpdGVtJ10pO1xuICAgICAgICBjb25zdCAkY2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAkY2hlY2tCb3gudHlwZSA9ICdjaGVja2JveCc7XG4gICAgICAgICRpdGVtLmFwcGVuZENoaWxkKCRjaGVja0JveCk7XG4gICAgICAgICRpdGVtLmFwcGVuZENoaWxkKGNyZWF0ZUh0bWxFbGVtZW50KCdkaXYnLCBbJ3RleHQnXSwgaXRlbS5jb250ZW50KSk7XG4gICAgICAgICRpdGVtLmFwcGVuZENoaWxkKGNyZWF0ZUh0bWxFbGVtZW50KCdkaXYnLCBbJ2RlbGV0ZScsICdidG4nXSwgJ3gnKSk7XG4gICAgICAgIHJldHVybiAkaXRlbTtcbiAgICB9XG5cbiAgICBjb25zdCBzaG93SXRlbXMgPSAoaXRlbXMpID0+IHtcbiAgICAgICAgd2hpbGUoJGl0ZW1Db250YWluZXIuY2hpbGRFbGVtZW50Q291bnQgPiAwKSBcbiAgICAgICAgICAgICRpdGVtQ29udGFpbmVyLmxhc3RDaGlsZC5yZW1vdmUoKTsgIC8vIENsZWFyIGNvbnRlbnRzXG5cbiAgICAgICAgaXRlbXMubWFwKGl0ZW0gPT4gYWRkSXRlbURPTShpdGVtKSk7XG5cbiAgICB9XG5cbiAgICBjb25zdCBhZGRJdGVtTGlzdGVuZXIgPSAoJGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgaXRlbUVsZW1lbnRzID0gQXJyYXkuZnJvbSgkaXRlbS5jaGlsZHJlbik7XG4gICAgICAgIGNvbnN0IGl0ZW1Db250ZW50ID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZXh0JykpLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCAkZGVsZXRlQnRuID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxldGUnKSk7XG4gICAgICAgIFxuICAgICAgICAkZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlSXRlbURPTSgkZGVsZXRlQnRuLnBhcmVudE5vZGUsIGl0ZW1Db250ZW50KTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCBhZGRJdGVtRE9NID0gKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgJG5ld0l0ZW0gPSBuZXdJdGVtRE9NKGl0ZW0pO1xuICAgICAgICAkaXRlbUNvbnRhaW5lci5hcHBlbmRDaGlsZCgkbmV3SXRlbSk7XG4gICAgICAgIGFkZEl0ZW1MaXN0ZW5lcigkbmV3SXRlbSk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlSXRlbURPTSA9ICgkaXRlbSwgaXRlbUNvbnRlbnQpID0+IHtcbiAgICAgICAgJGl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdyZW1vdmVJdGVtJywge2FjdGl2ZUNhdGVnb3J5TmFtZTogZ2V0Q2F0ZWdvcnlOYW1lKCRjdXJyZW50QWN0aXZlKSwgaXRlbUNvbnRlbnR9KTtcbiAgICB9XG5cbiAgICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgICAgICAvLyBDYXRlZ29yaWVzXG4gICAgICAgICRhZGRDYXRlZ29yeUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdhZGRDYXRlZ29yeScsIHByb21wdCgnRW50ZXInKSk7XG4gICAgICAgIH0pXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2NhdGVnb3J5QWRkZWQnLCBhZGRDYXRlZ29yeURPTSk7XG5cbiAgICAgICAgLy8gSXRlbXNcbiAgICAgICAgJGFkZEl0ZW1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhY3RpdmVDYXRlZ29yeU5hbWUgPSAkY3VycmVudEFjdGl2ZS5maXJzdENoaWxkLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgaXRlbUNvbnRlbnQgPSBwcm9tcHQoJ0VudGVyJyk7XG4gICAgICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkSXRlbScsIHthY3RpdmVDYXRlZ29yeU5hbWUsIGl0ZW1Db250ZW50fSk7XG4gICAgICAgIH0pXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2NhdGVnb3J5SXRlbXNMb2FkZWQnLCBzaG93SXRlbXMpO1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdpdGVtQWRkZWQnLCBhZGRJdGVtRE9NKTtcbiAgICAgICAgXG5cbiAgICAgICAgLy9EZWZhdWx0c1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkQ2F0ZWdvcnknLCAnQWxsJyk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdhZGRDYXRlZ29yeScsICdSYW5kb20nKTtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2FkZENhdGVnb3J5JywgJ0NhdGVnb3JpZXMnKTtcblxuICAgICAgICBzZXRBY3RpdmUoJGNhdGVnb3J5Q29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkKTsgICAgICAgIFxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQsXG4gICAgICAgIHNldEFjdGl2ZSxcbiAgICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgVUk7XG5cblxuXG4iLCJpbXBvcnQgUHViU3ViIGZyb20gXCIuL21vZHVsZXMvcHVic3ViXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vbW9kdWxlcy9VSVwiO1xuaW1wb3J0IENhdGVnb3J5IGZyb20gXCIuL21vZHVsZXMvY2F0ZWdvcnlcIlxuXG5jb25zdCBDYXRlZ29yeUNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuXG4gICAgLy8gQ2F0ZWdvcnlcblxuICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBbXTtcblxuICAgIGNvbnN0IGdldENhdGVnb3J5ID0gKGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gY2F0ZWdvcmllcy5maW5kKGNhdCA9PiBjYXQuZ2V0TmFtZSgpID09PSBjYXRlZ29yeU5hbWUpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBhZGRDYXRlZ29yeSA9IChjYXRlZ29yeU5hbWUpID0+IHtcbiAgICAgICAgaWYgKGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdUaGlzIGNhdGVnb3J5IGFscmVhZHkgZXhpc3RzIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNhdCA9IENhdGVnb3J5KGNhdGVnb3J5TmFtZSk7XG4gICAgICAgIGNhdGVnb3JpZXMucHVzaChjYXQpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnY2F0ZWdvcnlBZGRlZCcsIGNhdCk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlQ2F0ZWdvcnkgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gY2F0ZWdvcmllcy5pbmRleE9mKGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkpO1xuICAgICAgICBjYXRlZ29yaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgLy8gSXRlbXNcblxuICAgIGNvbnN0IGdldEl0ZW1zID0gKGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkuZ2V0SXRlbXMoKTtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2NhdGVnb3J5SXRlbXNMb2FkZWQnLCBpdGVtcyk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkSXRlbSA9ICh7YWN0aXZlQ2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pID0+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlQ2F0ID0gZ2V0Q2F0ZWdvcnkoYWN0aXZlQ2F0ZWdvcnlOYW1lKTtcbiAgICAgICAgY29uc3QgaXRlbSA9IGFjdGl2ZUNhdC5hZGRJdGVtKGl0ZW1Db250ZW50KTtcbiAgICAgICAgaWYgKGFjdGl2ZUNhdCAhPSBjYXRlZ29yaWVzWzBdKSBjYXRlZ29yaWVzWzBdLmFkZEl0ZW0oaXRlbUNvbnRlbnQpOyAvLyBBZGQgdG8gSG9tZVxuICAgICAgICBQdWJTdWIucHVibGlzaCgnaXRlbUFkZGVkJywgaXRlbSk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlSXRlbSA9ICh7YWN0aXZlQ2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pID0+IHtcbiAgICAgICAgZ2V0Q2F0ZWdvcnkoYWN0aXZlQ2F0ZWdvcnlOYW1lKS5yZW1vdmVJdGVtKGl0ZW1Db250ZW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdhZGRDYXRlZ29yeScsIGFkZENhdGVnb3J5KTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgncmVtb3ZlQ2F0ZWdvcnknLCByZW1vdmVDYXRlZ29yeSk7XG5cbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgnY2F0ZWdvcnlBY3RpdmUnLCBnZXRJdGVtcyk7XG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2FkZEl0ZW0nLCBhZGRJdGVtKTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgncmVtb3ZlSXRlbScsIHJlbW92ZUl0ZW0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQsXG4gICAgfTtcbn0pKCk7XG5cbkNhdGVnb3J5Q29udHJvbGxlci5pbml0KCk7XG5VSS5pbml0KCk7XG5cblxuXG5cblxuXG5cblxuIiwiaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi9wdWJzdWJcIjtcblxuY29uc3QgSXRlbSA9IChpc0RvbmUsIGNvbnRlbnQpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpc0RvbmUsXG4gICAgICAgIGNvbnRlbnQsXG4gICAgfTtcbn1cblxuY29uc3QgQ2F0ZWdvcnkgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgbGV0IG5hbWUgPSBjYXRlZ29yeU5hbWU7XG4gICAgbGV0IGl0ZW1zID0gW107XG5cbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZTtcblxuICAgIGNvbnN0IGFkZEl0ZW0gPSAoaXRlbUNvbnRlbnQpID0+IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IEl0ZW0oZmFsc2UsIGl0ZW1Db250ZW50KTtcbiAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlSXRlbSA9IChpdGVtQ29udGVudCkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gaXRlbXMuZmluZChpdGVtID0+IGl0ZW0uY29udGVudCA9PT0gaXRlbUNvbnRlbnQpO1xuICAgICAgICBjb25zdCBpbmRleCA9IGl0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgICAgIGl0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgY29uc3QgZ2V0SXRlbXMgPSAoKSA9PiBpdGVtcztcblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldE5hbWUsXG4gICAgICAgIGFkZEl0ZW0sXG4gICAgICAgIHJlbW92ZUl0ZW0sXG4gICAgICAgIGdldEl0ZW1zLFxuICAgIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhdGVnb3J5OyJdLCJuYW1lcyI6WyJfZXZlbnRzIiwiY2hlY2tFdmVudCIsImV2ZW50TmFtZSIsImV2ZW50IiwiZmluZCIsImdldE5hbWUiLCJuYW1lIiwiaGFuZGxlcnMiLCJhZGRIYW5kbGVyIiwiaGFuZGxlciIsInB1c2giLCJpbnZva2VIYW5kbGVycyIsImV2ZW50QXJncyIsImZvckVhY2giLCJmbiIsIl9FdmVudCIsInB1Ymxpc2giLCJzdWJzY3JpYmUiLCJVSSIsImNyZWF0ZUh0bWxFbGVtZW50IiwidHlwZSIsImNsYXNzQXJyYXkiLCJjb250ZW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNscyIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwiZ2V0Q2F0ZWdvcnlOYW1lIiwiJGNhdGVnb3J5IiwidmFsdWUiLCJzcGxpdCIsIiRjYXRlZ29yeUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCIkYWRkQ2F0ZWdvcnlCdG4iLCIkY3VycmVudEFjdGl2ZSIsInNldEFjdGl2ZSIsInJlbW92ZSIsImFkZENhdGVnb3J5RE9NIiwiY2F0ZWdvcnkiLCIkbmV3Q2F0ZWdvcnkiLCIkY2F0IiwiYXBwZW5kQ2hpbGQiLCJjaGlsZEVsZW1lbnRDb3VudCIsIm5ld0NhdGVnb3J5IiwiJGRlbGV0ZUJ0biIsImxhc3RDaGlsZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlQ2F0ZWdvcnlET00iLCJwYXJlbnROb2RlIiwiYWRkQ2F0ZWdvcnlMaXN0ZW5lciIsImZpcnN0RWxlbWVudENoaWxkIiwiJGl0ZW1Db250YWluZXIiLCIkYWRkSXRlbUJ0biIsInNob3dJdGVtcyIsIml0ZW1zIiwibWFwIiwiaXRlbSIsImFkZEl0ZW1ET00iLCIkbmV3SXRlbSIsIiRpdGVtIiwiJGNoZWNrQm94IiwibmV3SXRlbURPTSIsIml0ZW1FbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsImNoaWxkcmVuIiwiaXRlbUNvbnRlbnQiLCJlbCIsImNvbnRhaW5zIiwicmVtb3ZlSXRlbURPTSIsImFkZEl0ZW1MaXN0ZW5lciIsImFjdGl2ZUNhdGVnb3J5TmFtZSIsImluaXQiLCJwcm9tcHQiLCJmaXJzdENoaWxkIiwiY2F0ZWdvcmllcyIsImdldENhdGVnb3J5IiwiY2F0ZWdvcnlOYW1lIiwiY2F0IiwiYWRkQ2F0ZWdvcnkiLCJhbGVydCIsImFkZEl0ZW0iLCJpc0RvbmUiLCJyZW1vdmVJdGVtIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZ2V0SXRlbXMiLCJyZW1vdmVDYXRlZ29yeSIsImFjdGl2ZUNhdCJdLCJzb3VyY2VSb290IjoiIn0=