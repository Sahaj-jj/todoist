(()=>{"use strict";const e=(()=>{const e=[],t=t=>{let n=e.find((e=>e.getName()===t));return n||(n=(e=>{let t=e,n=[];return{getName:()=>t,addHandler:e=>{n.push(e)},invokeHandlers:e=>{n.forEach((t=>{t(e)}))}}})(t),e.push(n)),n};return{publish:(e,n)=>{t(e).invokeHandlers(n)},subscribe:(e,n)=>{t(e).addHandler(n)}}})(),t=(()=>{const t=(e,t=null,n=null)=>{const i=document.createElement(e);return t&&t.forEach((e=>i.classList.add(e))),n&&(i.textContent=n),i},n=e=>e.classList.value.split(" ")[0],i=document.querySelector(".category-container"),s=document.querySelector(".add-category"),d=document.querySelector(".left-container .input-container");let o,c,a;[o,c,a]=d.children;const r=document.getElementById("active-category");let l=null;const m=t=>{l&&l.classList.remove("active"),t.classList.add("active"),l=t;const i=n(t);r.textContent=i,e.publish("categoryActive",i)},u=e=>{const s=(e=>{const n=t("div",[e.getName(),"category"]);return n.appendChild(t("div",["text"],e.getName())),0!=i.childElementCount&&n.appendChild(t("div",["delete","btn"],"x")),n})(e);i.appendChild(s),(e=>{n(e);const t=e.lastChild;t.addEventListener("click",(e=>{e.stopPropagation(),p(t.parentNode)})),e.addEventListener("click",(()=>m(e)))})(s),m(s)},p=t=>{e.publish("removeCategory",n(t));const s=i.firstElementChild;t!=l&&l!=s||m(s),t.remove()},g=()=>{d.style.display="flex",s.style.display="none",o.value="",o.focus()},h=()=>{e.publish("addCategory",o.value),reset()},y=()=>{d.style.display="none",s.style.display="block"},b=document.querySelector(".item-container"),v=document.querySelector(".add-item"),C=e=>{for(;b.childElementCount>0;)b.lastChild.remove();e.map((e=>f(e)))},f=e=>{const s=(e=>{const s=t("div",[e.categoryName,"item"]),d=document.createElement("input");return d.type="checkbox",e.isDone&&(s.classList.add("done"),d.checked=!0),s.appendChild(d),s.appendChild(t("div",["text"],e.content)),l==i.firstElementChild&&n(s)!=n(l)&&s.appendChild(t("div",["tag"],n(s))),s.appendChild(t("div",["delete","btn"],"x")),s})(e);b.appendChild(s),(e=>{const t=Array.from(e.children),n=t.find((e=>e.classList.contains("text"))).textContent,i=t.find((e=>e.classList.contains("delete"))),s=t.find((e=>"checkbox"==e.type));i.addEventListener("click",(()=>E(e,n))),s.addEventListener("click",(()=>L(s,n)))})(s)},E=(t,i)=>{t.remove(),e.publish("removeItem",{categoryName:n(t),itemContent:i})},L=(t,i)=>{const s=t.parentNode;t.checked?s.classList.add("done"):s.classList.remove("done"),e.publish("toggleDone",{categoryName:n(s),itemContent:i,isDone:t.checked})};return{init:()=>{s.addEventListener("click",g),e.subscribe("categoryAdded",u),c.addEventListener("click",h),a.addEventListener("click",y),v.addEventListener("click",(()=>{const t=l.firstChild.textContent,n=prompt("Enter");e.publish("addItem",{categoryName:t,itemContent:n})})),e.subscribe("categoryItemsLoaded",C),e.subscribe("itemAdded",f),e.publish("addCategory","All"),e.publish("addCategory","Random"),e.publish("addCategory","Categories"),m(i.firstElementChild)}}})(),n=t;(()=>{const t=[],n=e=>t.find((t=>t.getName()===e)),i=i=>{if(console.log(i),n(i))return void alert("This category already exists!");const s=(e=>{let t=e,n=[];const i=e=>n.find((t=>t.content===e));return{getName:()=>t,addItem:(e,t)=>{const i=((e,t,n)=>({isDone:!1,content:t,categoryName:n}))(0,e,t);return n.push(i),i},removeItem:e=>{const t=i(e);if(null==t)return null;const s=n.indexOf(t);return n.splice(s,1),t},toggleDone:e=>{const t=i(e);t.isDone=!t.isDone},getItems:()=>n}})(i);t.push(s),e.publish("categoryAdded",s)},s=e=>{const i=t.indexOf(n(e));t.splice(i,1)},d=i=>{let s=[];i===t[0].getName()?t.map((e=>e.getItems().map((e=>s.push(e))))):s=n(i).getItems(),e.publish("categoryItemsLoaded",s)},o=({categoryName:t,itemContent:i})=>{const s=n(t).addItem(i,t);e.publish("itemAdded",s)},c=({categoryName:e,itemContent:t})=>{n(e).removeItem(t)},a=({categoryName:e,itemContent:t})=>{n(e).toggleDone(t)};return{init:()=>{e.subscribe("addCategory",i),e.subscribe("removeCategory",s),e.subscribe("categoryActive",d),e.subscribe("addItem",o),e.subscribe("removeItem",c),e.subscribe("toggleDone",a)}}})().init(),n.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFHbkN3QixFQUFhLEVBQUVqRSxhQUFBQSxFQUFjeUMsWUFBQUEsTUFDL0JVLEVBQVluRCxHQUFjaUUsV0FBV3hCLElBYXpDLE1BQU8sQ0FDSE0sS0FYUyxLQUNULFlBQWlCLGNBQWVNLEdBQ2hDLFlBQWlCLGlCQUFrQmMsR0FFbkMsWUFBaUIsaUJBQWtCRCxHQUNuQyxZQUFpQixVQUFXUixHQUM1QixZQUFpQixhQUFjRSxHQUMvQixZQUFpQixhQUFjSyxNQXpEWixHQWlFUmxCLE9BQ25CLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvaXN0Ly4vc3JjL21vZHVsZXMvcHVic3ViLmpzIiwid2VicGFjazovL3RvZG9pc3QvLi9zcmMvbW9kdWxlcy9VSS5qcyIsIndlYnBhY2s6Ly90b2RvaXN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvZG9pc3QvLi9zcmMvbW9kdWxlcy9jYXRlZ29yeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuRXZlbnRzIDpcblxuYWRkSXRlbVxuaXRlbUFkZGVkXG5cbmFkZENhdGVnb3J5XG5yZW1vdmVDYXRlZ29yeVxuY2F0ZWdvcnlBZGRlZFxuY2F0ZWdvcnlSZW1vdmVkXG5cbiovXG5cblxuY29uc3QgX0V2ZW50ID0gKGV2ZW50TmFtZSkgPT4ge1xuICAgIGxldCBuYW1lID0gZXZlbnROYW1lO1xuICAgIGxldCBoYW5kbGVycyA9IFtdO1xuXG4gICAgY29uc3QgZ2V0TmFtZSA9ICgpID0+IG5hbWU7XG4gICAgY29uc3QgYWRkSGFuZGxlciA9IChoYW5kbGVyKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfSAgIFxuICAgIGNvbnN0IGludm9rZUhhbmRsZXJzID0gKGV2ZW50QXJncykgPT4ge1xuICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGZuID0+IHtcbiAgICAgICAgICAgIGZuKGV2ZW50QXJncyk7XG4gICAgICAgIH0pXG4gICAgfVxuICAgICByZXR1cm4geyBnZXROYW1lLCBhZGRIYW5kbGVyLCBpbnZva2VIYW5kbGVycyx9O1xufVxuXG5jb25zdCBQdWJTdWIgPSAoKCkgPT4ge1xuICAgIGNvbnN0IF9ldmVudHMgPSBbXTtcblxuICAgIGNvbnN0IGNoZWNrRXZlbnQgID0gKGV2ZW50TmFtZSkgPT4ge1xuICAgICAgICBsZXQgZXZlbnQgPSBfZXZlbnRzLmZpbmQoZXZlbnQgPT4gZXZlbnQuZ2V0TmFtZSgpID09PSBldmVudE5hbWUpO1xuICAgICAgICBpZiAoIWV2ZW50KSB7XG4gICAgICAgICAgICBldmVudCA9IF9FdmVudChldmVudE5hbWUpO1xuICAgICAgICAgICAgX2V2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuXG4gICAgY29uc3QgcHVibGlzaCA9IChldmVudE5hbWUsIGV2ZW50QXJncykgPT4ge1xuICAgICAgICBjb25zdCBldmVudCA9IGNoZWNrRXZlbnQoZXZlbnROYW1lKTtcbiAgICAgICAgZXZlbnQuaW52b2tlSGFuZGxlcnMoZXZlbnRBcmdzKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdWJzY3JpYmUgPSAoZXZlbnROYW1lLCBoYW5kbGVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gY2hlY2tFdmVudChldmVudE5hbWUpO1xuICAgICAgICBldmVudC5hZGRIYW5kbGVyKGhhbmRsZXIpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHB1Ymxpc2gsIFxuICAgICAgICBzdWJzY3JpYmUsXG4gICAgfTtcblxufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgUHViU3ViOyIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4vcHVic3ViXCI7XG5cbmNvbnN0IFVJID0gKCgpID0+IHtcblxuICAgIC8qXG4gICAgVXRpbFxuICAgICovXG5cbiAgICBjb25zdCBjcmVhdGVIdG1sRWxlbWVudCA9ICh0eXBlLCBjbGFzc0FycmF5ID0gbnVsbCwgY29udGVudCA9IG51bGwpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XG4gICAgICAgIGlmIChjbGFzc0FycmF5KSBjbGFzc0FycmF5LmZvckVhY2goY2xzID0+IGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbHMpKTtcbiAgICAgICAgaWYgKGNvbnRlbnQpIGVsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG5cbiAgICBjb25zdCBnZXRDYXRlZ29yeU5hbWUgPSAoJGVsZW1lbnQpID0+IHtcbiAgICAgICAgcmV0dXJuICRlbGVtZW50LmNsYXNzTGlzdC52YWx1ZS5zcGxpdCgnICcpWzBdO1xuICAgIH1cblxuICAgIC8qXG4gICAgQ2F0ZWdvcmllcyBVSVxuICAgICovXG5cbiAgICBjb25zdCAkY2F0ZWdvcnlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2F0ZWdvcnktY29udGFpbmVyJyk7XG4gICAgY29uc3QgJGFkZENhdGVnb3J5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1jYXRlZ29yeScpO1xuICAgIGNvbnN0ICRjYXRlZ29yeUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxlZnQtY29udGFpbmVyIC5pbnB1dC1jb250YWluZXInKTtcbiAgICBsZXQgJGlucHV0LCAkb2tCdG4sICRjYW5jZWxCdG47XG4gICAgWyRpbnB1dCwgJG9rQnRuLCAkY2FuY2VsQnRuXSA9ICRjYXRlZ29yeUlucHV0LmNoaWxkcmVuO1xuICAgIGNvbnN0ICRhY3RpdmVDYXRlZ29yeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmUtY2F0ZWdvcnknKTtcbiAgICBsZXQgJGN1cnJlbnRBY3RpdmUgPSBudWxsO1xuXG4gICAgY29uc3QgbmV3Q2F0ZWdvcnkgPSAoY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgY29uc3QgJGNhdCA9IGNyZWF0ZUh0bWxFbGVtZW50KCdkaXYnLCBbY2F0ZWdvcnkuZ2V0TmFtZSgpLCAnY2F0ZWdvcnknXSk7XG4gICAgICAgICRjYXQuYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGV4dCddLCBjYXRlZ29yeS5nZXROYW1lKCkpKTtcbiAgICAgICAgaWYgKCRjYXRlZ29yeUNvbnRhaW5lci5jaGlsZEVsZW1lbnRDb3VudCAhPSAwKVxuICAgICAgICAgICAgJGNhdC5hcHBlbmRDaGlsZChjcmVhdGVIdG1sRWxlbWVudCgnZGl2JywgWydkZWxldGUnLCAnYnRuJ10sICd4JykpO1xuICAgICAgICByZXR1cm4gJGNhdDtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRDYXRlZ29yeUxpc3RlbmVyID0gKCRjYXRlZ29yeSkgPT4ge1xuICAgICAgICBjb25zdCBjYXRlZ29yeU5hbWUgPSBnZXRDYXRlZ29yeU5hbWUoJGNhdGVnb3J5KTtcbiAgICAgICAgY29uc3QgJGRlbGV0ZUJ0biA9ICRjYXRlZ29yeS5sYXN0Q2hpbGQ7XG5cbiAgICAgICAgJGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgcmVtb3ZlQ2F0ZWdvcnlET00oJGRlbGV0ZUJ0bi5wYXJlbnROb2RlKTtcbiAgICAgICAgfSlcblxuICAgICAgICAkY2F0ZWdvcnkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzZXRBY3RpdmUoJGNhdGVnb3J5KSk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2V0QWN0aXZlID0gKCRjYXRlZ29yeSkgPT4ge1xuICAgICAgICBpZiAoJGN1cnJlbnRBY3RpdmUpICRjdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAkY2F0ZWdvcnkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICRjdXJyZW50QWN0aXZlID0gJGNhdGVnb3J5O1xuICAgICAgICBjb25zdCBjYXRlZ29yeU5hbWUgPSBnZXRDYXRlZ29yeU5hbWUoJGNhdGVnb3J5KTtcbiAgICAgICAgJGFjdGl2ZUNhdGVnb3J5LnRleHRDb250ZW50ID0gY2F0ZWdvcnlOYW1lO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnY2F0ZWdvcnlBY3RpdmUnLCBjYXRlZ29yeU5hbWUpO1xuICAgIH1cblxuICAgIGNvbnN0IGFkZENhdGVnb3J5RE9NID0gKGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIGNvbnN0ICRuZXdDYXRlZ29yeSA9IG5ld0NhdGVnb3J5KGNhdGVnb3J5KTtcbiAgICAgICAgJGNhdGVnb3J5Q29udGFpbmVyLmFwcGVuZENoaWxkKCRuZXdDYXRlZ29yeSk7XG4gICAgICAgIGFkZENhdGVnb3J5TGlzdGVuZXIoJG5ld0NhdGVnb3J5KTtcbiAgICAgICAgc2V0QWN0aXZlKCRuZXdDYXRlZ29yeSk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlQ2F0ZWdvcnlET00gPSAoJGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdyZW1vdmVDYXRlZ29yeScsIGdldENhdGVnb3J5TmFtZSgkY2F0ZWdvcnkpKTtcbiAgICAgICAgY29uc3QgJGZpcnN0Q2F0ZWdvcnkgPSAkY2F0ZWdvcnlDb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgIGlmICgkY2F0ZWdvcnkgPT0gJGN1cnJlbnRBY3RpdmUgfHwgJGN1cnJlbnRBY3RpdmUgPT0gJGZpcnN0Q2F0ZWdvcnkpIFxuICAgICAgICAgICAgc2V0QWN0aXZlKCRmaXJzdENhdGVnb3J5KTtcbiAgICAgICAgJGNhdGVnb3J5LnJlbW92ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IGlucHV0Q2F0ZWdvcnkgPSAoKSA9PiB7XG4gICAgICAgICRjYXRlZ29yeUlucHV0LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgICRhZGRDYXRlZ29yeUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAkaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgJGlucHV0LmZvY3VzKCk7XG5cbiAgICB9XG4gICAgY29uc3QgbG9hZElucHV0ID0gKCkgPT4ge1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkQ2F0ZWdvcnknLCAkaW5wdXQudmFsdWUpO1xuICAgICAgICByZXNldCgpO1xuICAgIH1cbiAgICBjb25zdCByZXNldElucHV0ID0gKCkgPT4ge1xuICAgICAgICAkY2F0ZWdvcnlJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAkYWRkQ2F0ZWdvcnlCdG4uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuXG4gICAgLypcbiAgICBJdGVtcyBVSVxuICAgICovXG4gICAgXG4gICAgY29uc3QgJGl0ZW1Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaXRlbS1jb250YWluZXInKTtcbiAgICBjb25zdCAkYWRkSXRlbUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtaXRlbScpO1xuXG4gICAgY29uc3QgbmV3SXRlbURPTSA9IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0ICRpdGVtID0gY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFtpdGVtLmNhdGVnb3J5TmFtZSwgJ2l0ZW0nXSk7XG4gICAgICAgIGNvbnN0ICRjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgICRjaGVja0JveC50eXBlID0gJ2NoZWNrYm94JztcbiAgICAgICAgaWYgKGl0ZW0uaXNEb25lKSB7XG4gICAgICAgICAgICAkaXRlbS5jbGFzc0xpc3QuYWRkKCdkb25lJyk7XG4gICAgICAgICAgICAkY2hlY2tCb3guY2hlY2tlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoJGNoZWNrQm94KTtcbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGV4dCddLCBpdGVtLmNvbnRlbnQpKTtcblxuICAgICAgICAvLyBMb2dpYyBmb3Igc2hvd2luZyB0YWdzIGluIGZpcnN0IGNhdGVnb3J5XG4gICAgICAgIGlmICgkY3VycmVudEFjdGl2ZSA9PSAkY2F0ZWdvcnlDb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGRcbiAgICAgICAgICAgICYmIGdldENhdGVnb3J5TmFtZSgkaXRlbSkgIT0gZ2V0Q2F0ZWdvcnlOYW1lKCRjdXJyZW50QWN0aXZlKSkge1xuICAgICAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGFnJ10sIGdldENhdGVnb3J5TmFtZSgkaXRlbSkpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsnZGVsZXRlJywgJ2J0biddLCAneCcpKTtcbiAgICAgICAgcmV0dXJuICRpdGVtO1xuICAgIH1cblxuICAgIGNvbnN0IHNob3dJdGVtcyA9IChpdGVtcykgPT4ge1xuICAgICAgICB3aGlsZSgkaXRlbUNvbnRhaW5lci5jaGlsZEVsZW1lbnRDb3VudCA+IDApIFxuICAgICAgICAgICAgJGl0ZW1Db250YWluZXIubGFzdENoaWxkLnJlbW92ZSgpOyAgLy8gQ2xlYXIgY29udGVudHNcblxuICAgICAgICBpdGVtcy5tYXAoaXRlbSA9PiBhZGRJdGVtRE9NKGl0ZW0pKTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRJdGVtTGlzdGVuZXIgPSAoJGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgaXRlbUVsZW1lbnRzID0gQXJyYXkuZnJvbSgkaXRlbS5jaGlsZHJlbik7XG4gICAgICAgIGNvbnN0IGl0ZW1Db250ZW50ID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZXh0JykpLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCAkZGVsZXRlQnRuID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxldGUnKSk7XG4gICAgICAgIGNvbnN0ICRjaGVja0JveCA9IGl0ZW1FbGVtZW50cy5maW5kKGVsID0+IGVsLnR5cGUgPT0gJ2NoZWNrYm94Jyk7XG4gICAgICAgIFxuICAgICAgICAkZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVtb3ZlSXRlbURPTSgkaXRlbSwgaXRlbUNvbnRlbnQpKTtcbiAgICAgICAgJGNoZWNrQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdG9nZ2xlRG9uZURPTSgkY2hlY2tCb3gsIGl0ZW1Db250ZW50KSk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkSXRlbURPTSA9IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0ICRuZXdJdGVtID0gbmV3SXRlbURPTShpdGVtKTtcbiAgICAgICAgJGl0ZW1Db250YWluZXIuYXBwZW5kQ2hpbGQoJG5ld0l0ZW0pO1xuICAgICAgICBhZGRJdGVtTGlzdGVuZXIoJG5ld0l0ZW0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUl0ZW1ET00gPSAoJGl0ZW0sIGl0ZW1Db250ZW50KSA9PiB7XG4gICAgICAgICRpdGVtLnJlbW92ZSgpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgncmVtb3ZlSXRlbScsIHtjYXRlZ29yeU5hbWU6IGdldENhdGVnb3J5TmFtZSgkaXRlbSksIGl0ZW1Db250ZW50fSk7XG4gICAgfVxuXG4gICAgY29uc3QgdG9nZ2xlRG9uZURPTSA9ICgkY2hlY2tCb3gsIGl0ZW1Db250ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0ICRpdGVtID0gJGNoZWNrQm94LnBhcmVudE5vZGU7XG4gICAgICAgICRjaGVja0JveC5jaGVja2VkID8gJGl0ZW0uY2xhc3NMaXN0LmFkZCgnZG9uZScpIDogJGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZG9uZScpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgndG9nZ2xlRG9uZScsIHtjYXRlZ29yeU5hbWU6IGdldENhdGVnb3J5TmFtZSgkaXRlbSksaXRlbUNvbnRlbnQsIGlzRG9uZTogJGNoZWNrQm94LmNoZWNrZWR9KTtcbiAgICB9IFxuXG4gICAgY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgICAgICAgLy8gQ2F0ZWdvcmllc1xuICAgICAgICAkYWRkQ2F0ZWdvcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbnB1dENhdGVnb3J5KTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgnY2F0ZWdvcnlBZGRlZCcsIGFkZENhdGVnb3J5RE9NKTtcbiAgICAgICAgJG9rQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZElucHV0KTtcbiAgICAgICAgJGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlc2V0SW5wdXQpO1xuXG4gICAgICAgIC8vIEl0ZW1zXG4gICAgICAgICRhZGRJdGVtQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gJGN1cnJlbnRBY3RpdmUuZmlyc3RDaGlsZC50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1Db250ZW50ID0gcHJvbXB0KCdFbnRlcicpO1xuICAgICAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2FkZEl0ZW0nLCB7Y2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pO1xuICAgICAgICB9KVxuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdjYXRlZ29yeUl0ZW1zTG9hZGVkJywgc2hvd0l0ZW1zKTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgnaXRlbUFkZGVkJywgYWRkSXRlbURPTSk7XG4gICAgICAgIFxuXG4gICAgICAgIC8vRGVmYXVsdHNcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2FkZENhdGVnb3J5JywgJ0FsbCcpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkQ2F0ZWdvcnknLCAnUmFuZG9tJyk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdhZGRDYXRlZ29yeScsICdDYXRlZ29yaWVzJyk7XG5cbiAgICAgICAgc2V0QWN0aXZlKCRjYXRlZ29yeUNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZCk7ICAgICAgICBcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0LFxuICAgIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBVSTtcblxuXG5cbiIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4vbW9kdWxlcy9wdWJzdWJcIjtcbmltcG9ydCBVSSBmcm9tIFwiLi9tb2R1bGVzL1VJXCI7XG5pbXBvcnQgQ2F0ZWdvcnkgZnJvbSBcIi4vbW9kdWxlcy9jYXRlZ29yeVwiXG5cbmNvbnN0IENhdGVnb3J5Q29udHJvbGxlciA9ICgoKSA9PiB7XG5cbiAgICAvLyBDYXRlZ29yeVxuXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IFtdO1xuXG4gICAgY29uc3QgZ2V0Q2F0ZWdvcnkgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICAgIHJldHVybiBjYXRlZ29yaWVzLmZpbmQoY2F0ID0+IGNhdC5nZXROYW1lKCkgPT09IGNhdGVnb3J5TmFtZSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGFkZENhdGVnb3J5ID0gKGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhjYXRlZ29yeU5hbWUpO1xuICAgICAgICBpZiAoZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKSkge1xuICAgICAgICAgICAgYWxlcnQoJ1RoaXMgY2F0ZWdvcnkgYWxyZWFkeSBleGlzdHMhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2F0ID0gQ2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKTtcbiAgICAgICAgY2F0ZWdvcmllcy5wdXNoKGNhdCk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdjYXRlZ29yeUFkZGVkJywgY2F0KTtcbiAgICB9XG5cbiAgICBjb25zdCByZW1vdmVDYXRlZ29yeSA9IChjYXRlZ29yeU5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBjYXRlZ29yaWVzLmluZGV4T2YoZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKSk7XG4gICAgICAgIGNhdGVnb3JpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG5cbiAgICAvLyBJdGVtc1xuXG4gICAgY29uc3QgZ2V0SXRlbXMgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICAgIGxldCBpdGVtcyA9IFtdO1xuICAgICAgICBpZiAoY2F0ZWdvcnlOYW1lID09PSBjYXRlZ29yaWVzWzBdLmdldE5hbWUoKSkge1xuICAgICAgICAgICAgY2F0ZWdvcmllcy5tYXAoY2F0ID0+IGNhdC5nZXRJdGVtcygpLm1hcChpdGVtID0+IGl0ZW1zLnB1c2goaXRlbSkpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGl0ZW1zID0gZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKS5nZXRJdGVtcygpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnY2F0ZWdvcnlJdGVtc0xvYWRlZCcsIGl0ZW1zKTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRJdGVtID0gKHtjYXRlZ29yeU5hbWUsIGl0ZW1Db250ZW50fSkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKS5hZGRJdGVtKGl0ZW1Db250ZW50LCBjYXRlZ29yeU5hbWUpOyAvLyBBZGQgdG8gSG9tZVxuICAgICAgICBQdWJTdWIucHVibGlzaCgnaXRlbUFkZGVkJywgaXRlbSk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlSXRlbSA9ICh7Y2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pID0+IHtcbiAgICAgICAgZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKS5yZW1vdmVJdGVtKGl0ZW1Db250ZW50KTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2dnbGVEb25lID0gKHtjYXRlZ29yeU5hbWUsIGl0ZW1Db250ZW50fSkgPT4ge1xuICAgICAgICBnZXRDYXRlZ29yeShjYXRlZ29yeU5hbWUpLnRvZ2dsZURvbmUoaXRlbUNvbnRlbnQpO1xuICAgIH1cblxuICAgIGNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2FkZENhdGVnb3J5JywgYWRkQ2F0ZWdvcnkpO1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdyZW1vdmVDYXRlZ29yeScsIHJlbW92ZUNhdGVnb3J5KTtcblxuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdjYXRlZ29yeUFjdGl2ZScsIGdldEl0ZW1zKTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgnYWRkSXRlbScsIGFkZEl0ZW0pO1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdyZW1vdmVJdGVtJywgcmVtb3ZlSXRlbSk7XG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ3RvZ2dsZURvbmUnLCB0b2dnbGVEb25lKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0LFxuICAgIH07XG59KSgpO1xuXG5DYXRlZ29yeUNvbnRyb2xsZXIuaW5pdCgpO1xuVUkuaW5pdCgpO1xuXG5cblxuXG5cblxuXG5cbiIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4vcHVic3ViXCI7XG5cbmNvbnN0IEl0ZW0gPSAoaXNEb25lLCBjb250ZW50LCBjYXRlZ29yeU5hbWUpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpc0RvbmUsXG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIGNhdGVnb3J5TmFtZSxcbiAgICB9O1xufVxuXG5jb25zdCBDYXRlZ29yeSA9IChjYXRlZ29yeU5hbWUpID0+IHtcbiAgICBsZXQgbmFtZSA9IGNhdGVnb3J5TmFtZTtcbiAgICBsZXQgaXRlbXMgPSBbXTtcblxuICAgIGNvbnN0IF9nZXRJdGVtID0gKGl0ZW1Db250ZW50KSA9PiAgaXRlbXMuZmluZChpdGVtID0+IGl0ZW0uY29udGVudCA9PT0gaXRlbUNvbnRlbnQpO1xuICAgIGNvbnN0IGdldE5hbWUgPSAoKSA9PiBuYW1lO1xuXG4gICAgY29uc3QgYWRkSXRlbSA9IChpdGVtQ29udGVudCwgY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBJdGVtKGZhbHNlLCBpdGVtQ29udGVudCwgY2F0ZWdvcnlOYW1lKTtcbiAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlSXRlbSA9IChpdGVtQ29udGVudCkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gX2dldEl0ZW0oaXRlbUNvbnRlbnQpO1xuICAgICAgICBpZiAoaXRlbSA9PSB1bmRlZmluZWQpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCBpbmRleCA9IGl0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgICAgIGl0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cblxuICAgIGNvbnN0IHRvZ2dsZURvbmUgPSAoaXRlbUNvbnRlbnQpID0+IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IF9nZXRJdGVtKGl0ZW1Db250ZW50KTtcbiAgICAgICAgaXRlbS5pc0RvbmUgPSAhaXRlbS5pc0RvbmU7XG4gICAgfVxuXG4gICAgY29uc3QgZ2V0SXRlbXMgPSAoKSA9PiBpdGVtcztcblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldE5hbWUsXG4gICAgICAgIGFkZEl0ZW0sXG4gICAgICAgIHJlbW92ZUl0ZW0sXG4gICAgICAgIHRvZ2dsZURvbmUsXG4gICAgICAgIGdldEl0ZW1zLFxuICAgIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhdGVnb3J5OyJdLCJuYW1lcyI6WyJfZXZlbnRzIiwiY2hlY2tFdmVudCIsImV2ZW50TmFtZSIsImV2ZW50IiwiZmluZCIsImdldE5hbWUiLCJuYW1lIiwiaGFuZGxlcnMiLCJhZGRIYW5kbGVyIiwiaGFuZGxlciIsInB1c2giLCJpbnZva2VIYW5kbGVycyIsImV2ZW50QXJncyIsImZvckVhY2giLCJmbiIsIl9FdmVudCIsInB1Ymxpc2giLCJzdWJzY3JpYmUiLCJVSSIsImNyZWF0ZUh0bWxFbGVtZW50IiwidHlwZSIsImNsYXNzQXJyYXkiLCJjb250ZW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNscyIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwiZ2V0Q2F0ZWdvcnlOYW1lIiwiJGVsZW1lbnQiLCJ2YWx1ZSIsInNwbGl0IiwiJGNhdGVnb3J5Q29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsIiRhZGRDYXRlZ29yeUJ0biIsIiRjYXRlZ29yeUlucHV0IiwiJGlucHV0IiwiJG9rQnRuIiwiJGNhbmNlbEJ0biIsImNoaWxkcmVuIiwiJGFjdGl2ZUNhdGVnb3J5IiwiZ2V0RWxlbWVudEJ5SWQiLCIkY3VycmVudEFjdGl2ZSIsInNldEFjdGl2ZSIsIiRjYXRlZ29yeSIsInJlbW92ZSIsImNhdGVnb3J5TmFtZSIsImFkZENhdGVnb3J5RE9NIiwiY2F0ZWdvcnkiLCIkbmV3Q2F0ZWdvcnkiLCIkY2F0IiwiYXBwZW5kQ2hpbGQiLCJjaGlsZEVsZW1lbnRDb3VudCIsIm5ld0NhdGVnb3J5IiwiJGRlbGV0ZUJ0biIsImxhc3RDaGlsZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlQ2F0ZWdvcnlET00iLCJwYXJlbnROb2RlIiwiYWRkQ2F0ZWdvcnlMaXN0ZW5lciIsIiRmaXJzdENhdGVnb3J5IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbnB1dENhdGVnb3J5Iiwic3R5bGUiLCJkaXNwbGF5IiwiZm9jdXMiLCJsb2FkSW5wdXQiLCJyZXNldCIsInJlc2V0SW5wdXQiLCIkaXRlbUNvbnRhaW5lciIsIiRhZGRJdGVtQnRuIiwic2hvd0l0ZW1zIiwiaXRlbXMiLCJtYXAiLCJpdGVtIiwiYWRkSXRlbURPTSIsIiRuZXdJdGVtIiwiJGl0ZW0iLCIkY2hlY2tCb3giLCJpc0RvbmUiLCJjaGVja2VkIiwibmV3SXRlbURPTSIsIml0ZW1FbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsIml0ZW1Db250ZW50IiwiZWwiLCJjb250YWlucyIsInJlbW92ZUl0ZW1ET00iLCJ0b2dnbGVEb25lRE9NIiwiYWRkSXRlbUxpc3RlbmVyIiwiaW5pdCIsImZpcnN0Q2hpbGQiLCJwcm9tcHQiLCJjYXRlZ29yaWVzIiwiZ2V0Q2F0ZWdvcnkiLCJjYXQiLCJhZGRDYXRlZ29yeSIsImNvbnNvbGUiLCJsb2ciLCJhbGVydCIsIl9nZXRJdGVtIiwiYWRkSXRlbSIsIkl0ZW0iLCJyZW1vdmVJdGVtIiwidW5kZWZpbmVkIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwidG9nZ2xlRG9uZSIsImdldEl0ZW1zIiwicmVtb3ZlQ2F0ZWdvcnkiXSwic291cmNlUm9vdCI6IiJ9