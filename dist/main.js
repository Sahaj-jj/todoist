(()=>{"use strict";const e=(()=>{const e=[],t=t=>{let n=e.find((e=>e.getName()===t));return n||(n=(e=>{let t=e,n=[];return{getName:()=>t,addHandler:e=>{n.push(e)},invokeHandlers:e=>{n.forEach((t=>{t(e)}))}}})(t),e.push(n)),n};return{publish:(e,n)=>{t(e).invokeHandlers(n)},subscribe:(e,n)=>{t(e).addHandler(n)}}})(),t=(()=>{const t=(e,t=null,n=null)=>{const i=document.createElement(e);return t&&t.forEach((e=>i.classList.add(e))),n&&(i.textContent=n),i},n=e=>e.classList.value.split(" ")[0],i=document.querySelector(".category-container"),s=document.querySelector(".add-category"),d=document.querySelector(".left-container .input-container"),o=document.getElementById("active-category");let c=null;const a=t=>{c&&c.classList.remove("active"),t.classList.add("active"),c=t;const i=n(t);o.textContent=i,e.publish("categoryActive",i)},r=e=>{const s=(e=>{const n=t("div",[e.getName(),"category"]);return n.appendChild(t("div",["text"],e.getName())),0!=i.childElementCount&&n.appendChild(t("div",["delete","btn"],"x")),n})(e);i.appendChild(s),(e=>{n(e);const t=e.lastChild;t.addEventListener("click",(e=>{e.stopPropagation(),l(t.parentNode)})),e.addEventListener("click",(()=>a(e)))})(s),a(s)},l=t=>{e.publish("removeCategory",n(t));const s=i.firstElementChild;t!=c&&c!=s||a(s),t.remove()},m=document.querySelector(".item-container"),u=document.querySelector(".add-item"),p=e=>{for(;m.childElementCount>0;)m.lastChild.remove();e.map((e=>g(e)))},g=e=>{const s=(e=>{const s=t("div",[e.categoryName,"item"]),d=document.createElement("input");return d.type="checkbox",e.isDone&&(s.classList.add("done"),d.checked=!0),s.appendChild(d),s.appendChild(t("div",["text"],e.content)),c==i.firstElementChild&&n(s)!=n(c)&&s.appendChild(t("div",["tag"],n(s))),s.appendChild(t("div",["delete","btn"],"x")),s})(e);m.appendChild(s),(e=>{const t=Array.from(e.children),n=t.find((e=>e.classList.contains("text"))).textContent,i=t.find((e=>e.classList.contains("delete"))),s=t.find((e=>"checkbox"==e.type));i.addEventListener("click",(()=>y(e,n))),s.addEventListener("click",(()=>h(s,n)))})(s)},y=(t,i)=>{t.remove(),e.publish("removeItem",{categoryName:n(t),itemContent:i})},h=(t,i)=>{const s=t.parentNode;t.checked?s.classList.add("done"):s.classList.remove("done"),e.publish("toggleDone",{categoryName:n(s),itemContent:i,isDone:t.checked})};return{init:()=>{s.addEventListener("click",(()=>{(()=>{let t,n,i;[t,n,i]=d.children,d.style.display="flex",s.style.display="none",t.value="",t.focus(),n.addEventListener("click",(()=>{e.publish("addCategory",t.value),d.style.display="none",s.style.display="block"}),{once:!0}),i.addEventListener("click",(()=>{d.style.display="none",s.style.display="block"}),{once:!0})})()})),e.subscribe("categoryAdded",r),u.addEventListener("click",(()=>{const t=c.firstChild.textContent,n=prompt("Enter");e.publish("addItem",{categoryName:t,itemContent:n})})),e.subscribe("categoryItemsLoaded",p),e.subscribe("itemAdded",g),e.publish("addCategory","All"),e.publish("addCategory","Random"),e.publish("addCategory","Categories"),a(i.firstElementChild)},setActive:a}})(),n=t;(()=>{const t=[],n=e=>t.find((t=>t.getName()===e)),i=i=>{if(n(i))return void alert("This category already exists!");const s=(e=>{let t=e,n=[];const i=e=>n.find((t=>t.content===e));return{getName:()=>t,addItem:(e,t)=>{const i=((e,t,n)=>({isDone:!1,content:t,categoryName:n}))(0,e,t);return n.push(i),i},removeItem:e=>{const t=i(e);if(null==t)return null;const s=n.indexOf(t);return n.splice(s,1),t},toggleDone:e=>{const t=i(e);t.isDone=!t.isDone},getItems:()=>n}})(i);t.push(s),e.publish("categoryAdded",s)},s=e=>{const i=t.indexOf(n(e));t.splice(i,1)},d=i=>{let s=[];i===t[0].getName()?t.map((e=>e.getItems().map((e=>s.push(e))))):s=n(i).getItems(),e.publish("categoryItemsLoaded",s)},o=({categoryName:t,itemContent:i})=>{const s=n(t).addItem(i,t);e.publish("itemAdded",s)},c=({categoryName:e,itemContent:t})=>{n(e).removeItem(t)},a=({categoryName:e,itemContent:t})=>{n(e).toggleDone(t)};return{init:()=>{e.subscribe("addCategory",i),e.subscribe("removeCategory",s),e.subscribe("categoryActive",d),e.subscribe("addItem",o),e.subscribe("removeItem",c),e.subscribe("toggleDone",a)}}})().init(),n.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBY0EsTUE2Q0EsRUE3QmUsTUFDWCxNQUFNQSxFQUFVLEdBRVZDLEVBQWVDLElBQ2pCLElBQUlDLEVBQVFILEVBQVFJLE1BQUtELEdBQVNBLEVBQU1FLFlBQWNILElBS3RELE9BSktDLElBQ0RBLEVBdEJHLENBQUNELElBQ1osSUFBSUksRUFBT0osRUFDUEssRUFBVyxHQVdkLE1BQU8sQ0FBRUYsUUFUTSxJQUFNQyxFQVNIRSxXQVJDQyxJQUNoQkYsRUFBU0csS0FBS0QsSUFPYUUsZUFMUEMsSUFDcEJMLEVBQVNNLFNBQVFDLElBQ2JBLEVBQUdGLFNBWUtHLENBQU9iLEdBQ2ZGLEVBQVFVLEtBQUtQLElBRVZBLEdBYVgsTUFBTyxDQUNIYSxRQVhZLENBQUNkLEVBQVdVLEtBQ1ZYLEVBQVdDLEdBQ25CUyxlQUFlQyxJQVVyQkssVUFQYyxDQUFDZixFQUFXTyxLQUNaUixFQUFXQyxHQUNuQk0sV0FBV0MsTUFuQlYsR0M1QlRTLEVBQUssTUFNUCxNQUFNQyxFQUFvQixDQUFDQyxFQUFNQyxFQUFhLEtBQU1DLEVBQVUsUUFDMUQsTUFBTUMsRUFBVUMsU0FBU0MsY0FBY0wsR0FHdkMsT0FGSUMsR0FBWUEsRUFBV1IsU0FBUWEsR0FBT0gsRUFBUUksVUFBVUMsSUFBSUYsS0FDNURKLElBQVNDLEVBQVFNLFlBQWNQLEdBQzVCQyxHQUdMTyxFQUFtQkMsR0FDZEEsRUFBU0osVUFBVUssTUFBTUMsTUFBTSxLQUFLLEdBT3pDQyxFQUFxQlYsU0FBU1csY0FBYyx1QkFDNUNDLEVBQWtCWixTQUFTVyxjQUFjLGlCQUN6Q0UsRUFBaUJiLFNBQVNXLGNBQWMsb0NBQ3hDRyxFQUFrQmQsU0FBU2UsZUFBZSxtQkFDaEQsSUFBSUMsRUFBaUIsS0FFckIsTUFvQk1DLEVBQWFDLElBQ1hGLEdBQWdCQSxFQUFlYixVQUFVZ0IsT0FBTyxVQUNwREQsRUFBVWYsVUFBVUMsSUFBSSxVQUN4QlksRUFBaUJFLEVBQ2pCLE1BQU1FLEVBQWVkLEVBQWdCWSxHQUNyQ0osRUFBZ0JULFlBQWNlLEVBQzlCLFVBQWUsaUJBQWtCQSxJQUcvQkMsRUFBa0JDLElBQ3BCLE1BQU1DLEVBOUJVLENBQUNELElBQ2pCLE1BQU1FLEVBQU83QixFQUFrQixNQUFPLENBQUMyQixFQUFTekMsVUFBVyxhQUkzRCxPQUhBMkMsRUFBS0MsWUFBWTlCLEVBQWtCLE1BQU8sQ0FBQyxRQUFTMkIsRUFBU3pDLFlBQ2pCLEdBQXhDNkIsRUFBbUJnQixtQkFDbkJGLEVBQUtDLFlBQVk5QixFQUFrQixNQUFPLENBQUMsU0FBVSxPQUFRLE1BQzFENkIsR0F5QmNHLENBQVlMLEdBQ2pDWixFQUFtQmUsWUFBWUYsR0F2QlAsQ0FBQ0wsSUFDSlosRUFBZ0JZLEdBQXJDLE1BQ01VLEVBQWFWLEVBQVVXLFVBRTdCRCxFQUFXRSxpQkFBaUIsU0FBVUMsSUFDbENBLEVBQUVDLGtCQUNGQyxFQUFrQkwsRUFBV00sZUFHakNoQixFQUFVWSxpQkFBaUIsU0FBUyxJQUFNYixFQUFVQyxNQWVwRGlCLENBQW9CWixHQUNwQk4sRUFBVU0sSUFHUlUsRUFBcUJmLElBQ3ZCLFVBQWUsaUJBQWtCWixFQUFnQlksSUFDakQsTUFBTWtCLEVBQWlCMUIsRUFBbUIyQixrQkFDdENuQixHQUFhRixHQUFrQkEsR0FBa0JvQixHQUNqRG5CLEVBQVVtQixHQUNkbEIsRUFBVUMsVUE0QlJtQixFQUFpQnRDLFNBQVNXLGNBQWMsbUJBQ3hDNEIsRUFBY3ZDLFNBQVNXLGNBQWMsYUF1QnJDNkIsRUFBYUMsSUFDZixLQUFNSCxFQUFlWixrQkFBb0IsR0FDckNZLEVBQWVULFVBQVVWLFNBRTdCc0IsRUFBTUMsS0FBSUMsR0FBUUMsRUFBV0QsTUFhM0JDLEVBQWNELElBQ2hCLE1BQU1FLEVBdkNTLENBQUNGLElBQ2hCLE1BQU1HLEVBQVFuRCxFQUFrQixNQUFPLENBQUNnRCxFQUFLdkIsYUFBYyxTQUNyRDJCLEVBQVkvQyxTQUFTQyxjQUFjLFNBZ0J6QyxPQWZBOEMsRUFBVW5ELEtBQU8sV0FDYitDLEVBQUtLLFNBQ0xGLEVBQU0zQyxVQUFVQyxJQUFJLFFBQ3BCMkMsRUFBVUUsU0FBVSxHQUV4QkgsRUFBTXJCLFlBQVlzQixHQUNsQkQsRUFBTXJCLFlBQVk5QixFQUFrQixNQUFPLENBQUMsUUFBU2dELEVBQUs3QyxVQUd0RGtCLEdBQWtCTixFQUFtQjJCLG1CQUNsQy9CLEVBQWdCd0MsSUFBVXhDLEVBQWdCVSxJQUM3QzhCLEVBQU1yQixZQUFZOUIsRUFBa0IsTUFBTyxDQUFDLE9BQVFXLEVBQWdCd0MsS0FHeEVBLEVBQU1yQixZQUFZOUIsRUFBa0IsTUFBTyxDQUFDLFNBQVUsT0FBUSxNQUN2RG1ELEdBcUJVSSxDQUFXUCxHQUM1QkwsRUFBZWIsWUFBWW9CLEdBWlAsQ0FBQ0MsSUFDckIsTUFBTUssRUFBZUMsTUFBTUMsS0FBS1AsRUFBTVEsVUFDaENDLEVBQWNKLEVBQWF2RSxNQUFLNEUsR0FBTUEsRUFBR3JELFVBQVVzRCxTQUFTLFVBQVNwRCxZQUNyRXVCLEVBQWF1QixFQUFhdkUsTUFBSzRFLEdBQU1BLEVBQUdyRCxVQUFVc0QsU0FBUyxZQUMzRFYsRUFBWUksRUFBYXZFLE1BQUs0RSxHQUFpQixZQUFYQSxFQUFHNUQsT0FFN0NnQyxFQUFXRSxpQkFBaUIsU0FBUyxJQUFNNEIsRUFBY1osRUFBT1MsS0FDaEVSLEVBQVVqQixpQkFBaUIsU0FBUyxJQUFNNkIsRUFBY1osRUFBV1EsTUFNbkVLLENBQWdCZixJQUdkYSxFQUFnQixDQUFDWixFQUFPUyxLQUMxQlQsRUFBTTNCLFNBQ04sVUFBZSxhQUFjLENBQUNDLGFBQWNkLEVBQWdCd0MsR0FBUVMsWUFBQUEsS0FHbEVJLEVBQWdCLENBQUNaLEVBQVdRLEtBQzlCLE1BQU1ULEVBQVFDLEVBQVViLFdBQ3hCYSxFQUFVRSxRQUFVSCxFQUFNM0MsVUFBVUMsSUFBSSxRQUFVMEMsRUFBTTNDLFVBQVVnQixPQUFPLFFBQ3pFLFVBQWUsYUFBYyxDQUFDQyxhQUFjZCxFQUFnQndDLEdBQU9TLFlBQUFBLEVBQWFQLE9BQVFELEVBQVVFLFdBNEJ0RyxNQUFPLENBQ0hZLEtBMUJTLEtBRVRqRCxFQUFnQmtCLGlCQUFpQixTQUFTLEtBckZ4QixNQUNsQixJQUFJZ0MsRUFBUUMsRUFBUUMsR0FDbkJGLEVBQVFDLEVBQVFDLEdBQWNuRCxFQUFleUMsU0FFOUN6QyxFQUFlb0QsTUFBTUMsUUFBVSxPQUMvQnRELEVBQWdCcUQsTUFBTUMsUUFBVSxPQUNoQ0osRUFBT3RELE1BQVEsR0FDZnNELEVBQU9LLFFBRVBKLEVBQU9qQyxpQkFBaUIsU0FBUyxLQUM3QixVQUFlLGNBQWVnQyxFQUFPdEQsT0FDckNLLEVBQWVvRCxNQUFNQyxRQUFVLE9BQy9CdEQsRUFBZ0JxRCxNQUFNQyxRQUFVLFVBQ2pDLENBQUNFLE1BQU0sSUFFVkosRUFBV2xDLGlCQUFpQixTQUFTLEtBQ2pDakIsRUFBZW9ELE1BQU1DLFFBQVUsT0FDL0J0RCxFQUFnQnFELE1BQU1DLFFBQVUsVUFDakMsQ0FBQ0UsTUFBTSxLQW9FTkMsTUFFSixZQUFpQixnQkFBaUJoRCxHQUdsQ2tCLEVBQVlULGlCQUFpQixTQUFTLEtBQ2xDLE1BQU1WLEVBQWVKLEVBQWVzRCxXQUFXakUsWUFDekNrRCxFQUFjZ0IsT0FBTyxTQUMzQixVQUFlLFVBQVcsQ0FBQ25ELGFBQUFBLEVBQWNtQyxZQUFBQSxPQUU3QyxZQUFpQixzQkFBdUJmLEdBQ3hDLFlBQWlCLFlBQWFJLEdBSTlCLFVBQWUsY0FBZSxPQUM5QixVQUFlLGNBQWUsVUFDOUIsVUFBZSxjQUFlLGNBRTlCM0IsRUFBVVAsRUFBbUIyQixvQkFLN0JwQixVQUFBQSxJQXJMRyxHQXlMWCxJQ3ZMMkIsTUFJdkIsTUFBTXVELEVBQWEsR0FFYkMsRUFBZXJELEdBQ1ZvRCxFQUFXNUYsTUFBSzhGLEdBQU9BLEVBQUk3RixZQUFjdUMsSUFHOUN1RCxFQUFldkQsSUFDakIsR0FBSXFELEVBQVlyRCxHQUVaLFlBREF3RCxNQUFNLGlDQUdWLE1BQU1GLEVDVEcsQ0FBQ3RELElBQ2QsSUFBSXRDLEVBQU9zQyxFQUNQcUIsRUFBUSxHQUVaLE1BQU1vQyxFQUFZdEIsR0FBaUJkLEVBQU03RCxNQUFLK0QsR0FBUUEsRUFBSzdDLFVBQVl5RCxJQXdCdkUsTUFBTyxDQUNIMUUsUUF4QlksSUFBTUMsRUF5QmxCZ0csUUF2QlksQ0FBQ3ZCLEVBQWFuQyxLQUMxQixNQUFNdUIsRUFoQkQsRUFBQ0ssRUFBUWxELEVBQVNzQixLQUNwQixDQUNINEIsUUFja0IsRUFibEJsRCxRQUFBQSxFQUNBc0IsYUFBQUEsSUFZYTJELENBQUssRUFBT3hCLEVBQWFuQyxHQUV0QyxPQURBcUIsRUFBTXZELEtBQUt5RCxHQUNKQSxHQXFCUHFDLFdBbEJnQnpCLElBQ2hCLE1BQU1aLEVBQU9rQyxFQUFTdEIsR0FDdEIsR0FBWTBCLE1BQVJ0QyxFQUFtQixPQUFPLEtBQzlCLE1BQU11QyxFQUFRekMsRUFBTTBDLFFBQVF4QyxHQUU1QixPQURBRixFQUFNMkMsT0FBT0YsRUFBTyxHQUNidkMsR0FjUDBDLFdBWGdCOUIsSUFDaEIsTUFBTVosRUFBT2tDLEVBQVN0QixHQUN0QlosRUFBS0ssUUFBVUwsRUFBS0ssUUFVcEJzQyxTQVBhLElBQU03QyxJRGpCUCxDQUFTckIsR0FDckJvRCxFQUFXdEYsS0FBS3dGLEdBQ2hCLFVBQWUsZ0JBQWlCQSxJQUc5QmEsRUFBa0JuRSxJQUNwQixNQUFNOEQsRUFBUVYsRUFBV1csUUFBUVYsRUFBWXJELElBQzdDb0QsRUFBV1ksT0FBT0YsRUFBTyxJQUt2QkksRUFBWWxFLElBQ2QsSUFBSXFCLEVBQVEsR0FDUnJCLElBQWlCb0QsRUFBVyxHQUFHM0YsVUFDL0IyRixFQUFXOUIsS0FBSWdDLEdBQU9BLEVBQUlZLFdBQVc1QyxLQUFJQyxHQUFRRixFQUFNdkQsS0FBS3lELE9BRTNERixFQUFRZ0MsRUFBWXJELEdBQWNrRSxXQUN2QyxVQUFlLHNCQUF1QjdDLElBR3BDcUMsRUFBVSxFQUFFMUQsYUFBQUEsRUFBY21DLFlBQUFBLE1BQzVCLE1BQU1aLEVBQU84QixFQUFZckQsR0FBYzBELFFBQVF2QixFQUFhbkMsR0FDNUQsVUFBZSxZQUFhdUIsSUFHMUJxQyxFQUFhLEVBQUU1RCxhQUFBQSxFQUFjbUMsWUFBQUEsTUFDL0JrQixFQUFZckQsR0FBYzRELFdBQVd6QixJQUduQzhCLEVBQWEsRUFBRWpFLGFBQUFBLEVBQWNtQyxZQUFBQSxNQUMvQmtCLEVBQVlyRCxHQUFjaUUsV0FBVzlCLElBYXpDLE1BQU8sQ0FDSE0sS0FYUyxLQUNULFlBQWlCLGNBQWVjLEdBQ2hDLFlBQWlCLGlCQUFrQlksR0FFbkMsWUFBaUIsaUJBQWtCRCxHQUNuQyxZQUFpQixVQUFXUixHQUM1QixZQUFpQixhQUFjRSxHQUMvQixZQUFpQixhQUFjSyxNQXhEWixHQWdFUnhCLE9BQ25CLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvaXN0Ly4vc3JjL21vZHVsZXMvcHVic3ViLmpzIiwid2VicGFjazovL3RvZG9pc3QvLi9zcmMvbW9kdWxlcy9VSS5qcyIsIndlYnBhY2s6Ly90b2RvaXN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvZG9pc3QvLi9zcmMvbW9kdWxlcy9jYXRlZ29yeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuRXZlbnRzIDpcblxuYWRkSXRlbVxuaXRlbUFkZGVkXG5cbmFkZENhdGVnb3J5XG5yZW1vdmVDYXRlZ29yeVxuY2F0ZWdvcnlBZGRlZFxuY2F0ZWdvcnlSZW1vdmVkXG5cbiovXG5cblxuY29uc3QgX0V2ZW50ID0gKGV2ZW50TmFtZSkgPT4ge1xuICAgIGxldCBuYW1lID0gZXZlbnROYW1lO1xuICAgIGxldCBoYW5kbGVycyA9IFtdO1xuXG4gICAgY29uc3QgZ2V0TmFtZSA9ICgpID0+IG5hbWU7XG4gICAgY29uc3QgYWRkSGFuZGxlciA9IChoYW5kbGVyKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfSAgIFxuICAgIGNvbnN0IGludm9rZUhhbmRsZXJzID0gKGV2ZW50QXJncykgPT4ge1xuICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGZuID0+IHtcbiAgICAgICAgICAgIGZuKGV2ZW50QXJncyk7XG4gICAgICAgIH0pXG4gICAgfVxuICAgICByZXR1cm4geyBnZXROYW1lLCBhZGRIYW5kbGVyLCBpbnZva2VIYW5kbGVycyx9O1xufVxuXG5jb25zdCBQdWJTdWIgPSAoKCkgPT4ge1xuICAgIGNvbnN0IF9ldmVudHMgPSBbXTtcblxuICAgIGNvbnN0IGNoZWNrRXZlbnQgID0gKGV2ZW50TmFtZSkgPT4ge1xuICAgICAgICBsZXQgZXZlbnQgPSBfZXZlbnRzLmZpbmQoZXZlbnQgPT4gZXZlbnQuZ2V0TmFtZSgpID09PSBldmVudE5hbWUpO1xuICAgICAgICBpZiAoIWV2ZW50KSB7XG4gICAgICAgICAgICBldmVudCA9IF9FdmVudChldmVudE5hbWUpO1xuICAgICAgICAgICAgX2V2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuXG4gICAgY29uc3QgcHVibGlzaCA9IChldmVudE5hbWUsIGV2ZW50QXJncykgPT4ge1xuICAgICAgICBjb25zdCBldmVudCA9IGNoZWNrRXZlbnQoZXZlbnROYW1lKTtcbiAgICAgICAgZXZlbnQuaW52b2tlSGFuZGxlcnMoZXZlbnRBcmdzKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdWJzY3JpYmUgPSAoZXZlbnROYW1lLCBoYW5kbGVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gY2hlY2tFdmVudChldmVudE5hbWUpO1xuICAgICAgICBldmVudC5hZGRIYW5kbGVyKGhhbmRsZXIpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHB1Ymxpc2gsIFxuICAgICAgICBzdWJzY3JpYmUsXG4gICAgfTtcblxufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgUHViU3ViOyIsImltcG9ydCBQdWJTdWIgZnJvbSBcIi4vcHVic3ViXCI7XG5cbmNvbnN0IFVJID0gKCgpID0+IHtcblxuICAgIC8qXG4gICAgVXRpbFxuICAgICovXG5cbiAgICBjb25zdCBjcmVhdGVIdG1sRWxlbWVudCA9ICh0eXBlLCBjbGFzc0FycmF5ID0gbnVsbCwgY29udGVudCA9IG51bGwpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XG4gICAgICAgIGlmIChjbGFzc0FycmF5KSBjbGFzc0FycmF5LmZvckVhY2goY2xzID0+IGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbHMpKTtcbiAgICAgICAgaWYgKGNvbnRlbnQpIGVsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG5cbiAgICBjb25zdCBnZXRDYXRlZ29yeU5hbWUgPSAoJGVsZW1lbnQpID0+IHtcbiAgICAgICAgcmV0dXJuICRlbGVtZW50LmNsYXNzTGlzdC52YWx1ZS5zcGxpdCgnICcpWzBdO1xuICAgIH1cblxuICAgIC8qXG4gICAgQ2F0ZWdvcmllcyBVSVxuICAgICovXG5cbiAgICBjb25zdCAkY2F0ZWdvcnlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2F0ZWdvcnktY29udGFpbmVyJyk7XG4gICAgY29uc3QgJGFkZENhdGVnb3J5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1jYXRlZ29yeScpO1xuICAgIGNvbnN0ICRjYXRlZ29yeUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxlZnQtY29udGFpbmVyIC5pbnB1dC1jb250YWluZXInKTtcbiAgICBjb25zdCAkYWN0aXZlQ2F0ZWdvcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWN0aXZlLWNhdGVnb3J5Jyk7XG4gICAgbGV0ICRjdXJyZW50QWN0aXZlID0gbnVsbDtcblxuICAgIGNvbnN0IG5ld0NhdGVnb3J5ID0gKGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIGNvbnN0ICRjYXQgPSBjcmVhdGVIdG1sRWxlbWVudCgnZGl2JywgW2NhdGVnb3J5LmdldE5hbWUoKSwgJ2NhdGVnb3J5J10pO1xuICAgICAgICAkY2F0LmFwcGVuZENoaWxkKGNyZWF0ZUh0bWxFbGVtZW50KCdkaXYnLCBbJ3RleHQnXSwgY2F0ZWdvcnkuZ2V0TmFtZSgpKSk7XG4gICAgICAgIGlmICgkY2F0ZWdvcnlDb250YWluZXIuY2hpbGRFbGVtZW50Q291bnQgIT0gMClcbiAgICAgICAgICAgICRjYXQuYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsnZGVsZXRlJywgJ2J0biddLCAneCcpKTtcbiAgICAgICAgcmV0dXJuICRjYXQ7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkQ2F0ZWdvcnlMaXN0ZW5lciA9ICgkY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gZ2V0Q2F0ZWdvcnlOYW1lKCRjYXRlZ29yeSk7XG4gICAgICAgIGNvbnN0ICRkZWxldGVCdG4gPSAkY2F0ZWdvcnkubGFzdENoaWxkO1xuXG4gICAgICAgICRkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHJlbW92ZUNhdGVnb3J5RE9NKCRkZWxldGVCdG4ucGFyZW50Tm9kZSk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgJGNhdGVnb3J5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2V0QWN0aXZlKCRjYXRlZ29yeSkpO1xuICAgIH1cblxuICAgIGNvbnN0IHNldEFjdGl2ZSA9ICgkY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgaWYgKCRjdXJyZW50QWN0aXZlKSAkY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgJGNhdGVnb3J5LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAkY3VycmVudEFjdGl2ZSA9ICRjYXRlZ29yeTtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gZ2V0Q2F0ZWdvcnlOYW1lKCRjYXRlZ29yeSk7XG4gICAgICAgICRhY3RpdmVDYXRlZ29yeS50ZXh0Q29udGVudCA9IGNhdGVnb3J5TmFtZTtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2NhdGVnb3J5QWN0aXZlJywgY2F0ZWdvcnlOYW1lKTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRDYXRlZ29yeURPTSA9IChjYXRlZ29yeSkgPT4ge1xuICAgICAgICBjb25zdCAkbmV3Q2F0ZWdvcnkgPSBuZXdDYXRlZ29yeShjYXRlZ29yeSk7XG4gICAgICAgICRjYXRlZ29yeUNvbnRhaW5lci5hcHBlbmRDaGlsZCgkbmV3Q2F0ZWdvcnkpO1xuICAgICAgICBhZGRDYXRlZ29yeUxpc3RlbmVyKCRuZXdDYXRlZ29yeSk7XG4gICAgICAgIHNldEFjdGl2ZSgkbmV3Q2F0ZWdvcnkpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUNhdGVnb3J5RE9NID0gKCRjYXRlZ29yeSkgPT4ge1xuICAgICAgICBQdWJTdWIucHVibGlzaCgncmVtb3ZlQ2F0ZWdvcnknLCBnZXRDYXRlZ29yeU5hbWUoJGNhdGVnb3J5KSk7XG4gICAgICAgIGNvbnN0ICRmaXJzdENhdGVnb3J5ID0gJGNhdGVnb3J5Q29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgICBpZiAoJGNhdGVnb3J5ID09ICRjdXJyZW50QWN0aXZlIHx8ICRjdXJyZW50QWN0aXZlID09ICRmaXJzdENhdGVnb3J5KSBcbiAgICAgICAgICAgIHNldEFjdGl2ZSgkZmlyc3RDYXRlZ29yeSk7XG4gICAgICAgICRjYXRlZ29yeS5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBjb25zdCBpbnB1dENhdGVnb3J5ID0gKCkgPT4ge1xuICAgICAgICBsZXQgJGlucHV0LCAkb2tCdG4sICRjYW5jZWxCdG47XG4gICAgICAgIFskaW5wdXQsICRva0J0biwgJGNhbmNlbEJ0bl0gPSAkY2F0ZWdvcnlJbnB1dC5jaGlsZHJlbjtcblxuICAgICAgICAkY2F0ZWdvcnlJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICAkYWRkQ2F0ZWdvcnlCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgJGlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgICRpbnB1dC5mb2N1cygpO1xuXG4gICAgICAgICRva0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdhZGRDYXRlZ29yeScsICRpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAkY2F0ZWdvcnlJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgJGFkZENhdGVnb3J5QnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9LCB7b25jZTogdHJ1ZX0pO1xuXG4gICAgICAgICRjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAkY2F0ZWdvcnlJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgJGFkZENhdGVnb3J5QnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG4gICAgfVxuXG4gICAgLypcbiAgICBJdGVtcyBVSVxuICAgICovXG4gICAgXG4gICAgY29uc3QgJGl0ZW1Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaXRlbS1jb250YWluZXInKTtcbiAgICBjb25zdCAkYWRkSXRlbUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtaXRlbScpO1xuXG4gICAgY29uc3QgbmV3SXRlbURPTSA9IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0ICRpdGVtID0gY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFtpdGVtLmNhdGVnb3J5TmFtZSwgJ2l0ZW0nXSk7XG4gICAgICAgIGNvbnN0ICRjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgICRjaGVja0JveC50eXBlID0gJ2NoZWNrYm94JztcbiAgICAgICAgaWYgKGl0ZW0uaXNEb25lKSB7XG4gICAgICAgICAgICAkaXRlbS5jbGFzc0xpc3QuYWRkKCdkb25lJyk7XG4gICAgICAgICAgICAkY2hlY2tCb3guY2hlY2tlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoJGNoZWNrQm94KTtcbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGV4dCddLCBpdGVtLmNvbnRlbnQpKTtcblxuICAgICAgICAvLyBMb2dpYyBmb3Igc2hvd2luZyB0YWdzIGluIGZpcnN0IGNhdGVnb3J5XG4gICAgICAgIGlmICgkY3VycmVudEFjdGl2ZSA9PSAkY2F0ZWdvcnlDb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGRcbiAgICAgICAgICAgICYmIGdldENhdGVnb3J5TmFtZSgkaXRlbSkgIT0gZ2V0Q2F0ZWdvcnlOYW1lKCRjdXJyZW50QWN0aXZlKSkge1xuICAgICAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsndGFnJ10sIGdldENhdGVnb3J5TmFtZSgkaXRlbSkpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgJGl0ZW0uYXBwZW5kQ2hpbGQoY3JlYXRlSHRtbEVsZW1lbnQoJ2RpdicsIFsnZGVsZXRlJywgJ2J0biddLCAneCcpKTtcbiAgICAgICAgcmV0dXJuICRpdGVtO1xuICAgIH1cblxuICAgIGNvbnN0IHNob3dJdGVtcyA9IChpdGVtcykgPT4ge1xuICAgICAgICB3aGlsZSgkaXRlbUNvbnRhaW5lci5jaGlsZEVsZW1lbnRDb3VudCA+IDApIFxuICAgICAgICAgICAgJGl0ZW1Db250YWluZXIubGFzdENoaWxkLnJlbW92ZSgpOyAgLy8gQ2xlYXIgY29udGVudHNcblxuICAgICAgICBpdGVtcy5tYXAoaXRlbSA9PiBhZGRJdGVtRE9NKGl0ZW0pKTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRJdGVtTGlzdGVuZXIgPSAoJGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgaXRlbUVsZW1lbnRzID0gQXJyYXkuZnJvbSgkaXRlbS5jaGlsZHJlbik7XG4gICAgICAgIGNvbnN0IGl0ZW1Db250ZW50ID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZXh0JykpLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCAkZGVsZXRlQnRuID0gaXRlbUVsZW1lbnRzLmZpbmQoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxldGUnKSk7XG4gICAgICAgIGNvbnN0ICRjaGVja0JveCA9IGl0ZW1FbGVtZW50cy5maW5kKGVsID0+IGVsLnR5cGUgPT0gJ2NoZWNrYm94Jyk7XG4gICAgICAgIFxuICAgICAgICAkZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVtb3ZlSXRlbURPTSgkaXRlbSwgaXRlbUNvbnRlbnQpKTtcbiAgICAgICAgJGNoZWNrQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdG9nZ2xlRG9uZURPTSgkY2hlY2tCb3gsIGl0ZW1Db250ZW50KSk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkSXRlbURPTSA9IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0ICRuZXdJdGVtID0gbmV3SXRlbURPTShpdGVtKTtcbiAgICAgICAgJGl0ZW1Db250YWluZXIuYXBwZW5kQ2hpbGQoJG5ld0l0ZW0pO1xuICAgICAgICBhZGRJdGVtTGlzdGVuZXIoJG5ld0l0ZW0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUl0ZW1ET00gPSAoJGl0ZW0sIGl0ZW1Db250ZW50KSA9PiB7XG4gICAgICAgICRpdGVtLnJlbW92ZSgpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgncmVtb3ZlSXRlbScsIHtjYXRlZ29yeU5hbWU6IGdldENhdGVnb3J5TmFtZSgkaXRlbSksIGl0ZW1Db250ZW50fSk7XG4gICAgfVxuXG4gICAgY29uc3QgdG9nZ2xlRG9uZURPTSA9ICgkY2hlY2tCb3gsIGl0ZW1Db250ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0ICRpdGVtID0gJGNoZWNrQm94LnBhcmVudE5vZGU7XG4gICAgICAgICRjaGVja0JveC5jaGVja2VkID8gJGl0ZW0uY2xhc3NMaXN0LmFkZCgnZG9uZScpIDogJGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZG9uZScpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgndG9nZ2xlRG9uZScsIHtjYXRlZ29yeU5hbWU6IGdldENhdGVnb3J5TmFtZSgkaXRlbSksaXRlbUNvbnRlbnQsIGlzRG9uZTogJGNoZWNrQm94LmNoZWNrZWR9KTtcbiAgICB9IFxuXG4gICAgY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgICAgICAgLy8gQ2F0ZWdvcmllc1xuICAgICAgICAkYWRkQ2F0ZWdvcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBpbnB1dENhdGVnb3J5KCk7XG4gICAgICAgIH0pXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2NhdGVnb3J5QWRkZWQnLCBhZGRDYXRlZ29yeURPTSk7XG5cbiAgICAgICAgLy8gSXRlbXNcbiAgICAgICAgJGFkZEl0ZW1CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeU5hbWUgPSAkY3VycmVudEFjdGl2ZS5maXJzdENoaWxkLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgaXRlbUNvbnRlbnQgPSBwcm9tcHQoJ0VudGVyJyk7XG4gICAgICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkSXRlbScsIHtjYXRlZ29yeU5hbWUsIGl0ZW1Db250ZW50fSk7XG4gICAgICAgIH0pXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2NhdGVnb3J5SXRlbXNMb2FkZWQnLCBzaG93SXRlbXMpO1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdpdGVtQWRkZWQnLCBhZGRJdGVtRE9NKTtcbiAgICAgICAgXG5cbiAgICAgICAgLy9EZWZhdWx0c1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnYWRkQ2F0ZWdvcnknLCAnQWxsJyk7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdhZGRDYXRlZ29yeScsICdSYW5kb20nKTtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2FkZENhdGVnb3J5JywgJ0NhdGVnb3JpZXMnKTtcblxuICAgICAgICBzZXRBY3RpdmUoJGNhdGVnb3J5Q29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkKTsgICAgICAgIFxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQsXG4gICAgICAgIHNldEFjdGl2ZSxcbiAgICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgVUk7XG5cblxuXG4iLCJpbXBvcnQgUHViU3ViIGZyb20gXCIuL21vZHVsZXMvcHVic3ViXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vbW9kdWxlcy9VSVwiO1xuaW1wb3J0IENhdGVnb3J5IGZyb20gXCIuL21vZHVsZXMvY2F0ZWdvcnlcIlxuXG5jb25zdCBDYXRlZ29yeUNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuXG4gICAgLy8gQ2F0ZWdvcnlcblxuICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBbXTtcblxuICAgIGNvbnN0IGdldENhdGVnb3J5ID0gKGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gY2F0ZWdvcmllcy5maW5kKGNhdCA9PiBjYXQuZ2V0TmFtZSgpID09PSBjYXRlZ29yeU5hbWUpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBhZGRDYXRlZ29yeSA9IChjYXRlZ29yeU5hbWUpID0+IHtcbiAgICAgICAgaWYgKGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdUaGlzIGNhdGVnb3J5IGFscmVhZHkgZXhpc3RzIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNhdCA9IENhdGVnb3J5KGNhdGVnb3J5TmFtZSk7XG4gICAgICAgIGNhdGVnb3JpZXMucHVzaChjYXQpO1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnY2F0ZWdvcnlBZGRlZCcsIGNhdCk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlQ2F0ZWdvcnkgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gY2F0ZWdvcmllcy5pbmRleE9mKGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkpO1xuICAgICAgICBjYXRlZ29yaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgLy8gSXRlbXNcblxuICAgIGNvbnN0IGdldEl0ZW1zID0gKGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICBsZXQgaXRlbXMgPSBbXTtcbiAgICAgICAgaWYgKGNhdGVnb3J5TmFtZSA9PT0gY2F0ZWdvcmllc1swXS5nZXROYW1lKCkpIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXMubWFwKGNhdCA9PiBjYXQuZ2V0SXRlbXMoKS5tYXAoaXRlbSA9PiBpdGVtcy5wdXNoKGl0ZW0pKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpdGVtcyA9IGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkuZ2V0SXRlbXMoKTtcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2NhdGVnb3J5SXRlbXNMb2FkZWQnLCBpdGVtcyk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkSXRlbSA9ICh7Y2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pID0+IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkuYWRkSXRlbShpdGVtQ29udGVudCwgY2F0ZWdvcnlOYW1lKTsgLy8gQWRkIHRvIEhvbWVcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2l0ZW1BZGRlZCcsIGl0ZW0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUl0ZW0gPSAoe2NhdGVnb3J5TmFtZSwgaXRlbUNvbnRlbnR9KSA9PiB7XG4gICAgICAgIGdldENhdGVnb3J5KGNhdGVnb3J5TmFtZSkucmVtb3ZlSXRlbShpdGVtQ29udGVudCk7XG4gICAgfVxuXG4gICAgY29uc3QgdG9nZ2xlRG9uZSA9ICh7Y2F0ZWdvcnlOYW1lLCBpdGVtQ29udGVudH0pID0+IHtcbiAgICAgICAgZ2V0Q2F0ZWdvcnkoY2F0ZWdvcnlOYW1lKS50b2dnbGVEb25lKGl0ZW1Db250ZW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdhZGRDYXRlZ29yeScsIGFkZENhdGVnb3J5KTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgncmVtb3ZlQ2F0ZWdvcnknLCByZW1vdmVDYXRlZ29yeSk7XG5cbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgnY2F0ZWdvcnlBY3RpdmUnLCBnZXRJdGVtcyk7XG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ2FkZEl0ZW0nLCBhZGRJdGVtKTtcbiAgICAgICAgUHViU3ViLnN1YnNjcmliZSgncmVtb3ZlSXRlbScsIHJlbW92ZUl0ZW0pO1xuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCd0b2dnbGVEb25lJywgdG9nZ2xlRG9uZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdCxcbiAgICB9O1xufSkoKTtcblxuQ2F0ZWdvcnlDb250cm9sbGVyLmluaXQoKTtcblVJLmluaXQoKTtcblxuXG5cblxuXG5cblxuXG4iLCJpbXBvcnQgUHViU3ViIGZyb20gXCIuL3B1YnN1YlwiO1xuXG5jb25zdCBJdGVtID0gKGlzRG9uZSwgY29udGVudCwgY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaXNEb25lLFxuICAgICAgICBjb250ZW50LFxuICAgICAgICBjYXRlZ29yeU5hbWUsXG4gICAgfTtcbn1cblxuY29uc3QgQ2F0ZWdvcnkgPSAoY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgbGV0IG5hbWUgPSBjYXRlZ29yeU5hbWU7XG4gICAgbGV0IGl0ZW1zID0gW107XG5cbiAgICBjb25zdCBfZ2V0SXRlbSA9IChpdGVtQ29udGVudCkgPT4gIGl0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLmNvbnRlbnQgPT09IGl0ZW1Db250ZW50KTtcbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZTtcblxuICAgIGNvbnN0IGFkZEl0ZW0gPSAoaXRlbUNvbnRlbnQsIGNhdGVnb3J5TmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gSXRlbShmYWxzZSwgaXRlbUNvbnRlbnQsIGNhdGVnb3J5TmFtZSk7XG4gICAgICAgIGl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbW92ZUl0ZW0gPSAoaXRlbUNvbnRlbnQpID0+IHtcbiAgICAgICAgY29uc3QgaXRlbSA9IF9nZXRJdGVtKGl0ZW1Db250ZW50KTtcbiAgICAgICAgaWYgKGl0ZW0gPT0gdW5kZWZpbmVkKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgaW5kZXggPSBpdGVtcy5pbmRleE9mKGl0ZW0pO1xuICAgICAgICBpdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2dnbGVEb25lID0gKGl0ZW1Db250ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBfZ2V0SXRlbShpdGVtQ29udGVudCk7XG4gICAgICAgIGl0ZW0uaXNEb25lID0gIWl0ZW0uaXNEb25lO1xuICAgIH1cblxuICAgIGNvbnN0IGdldEl0ZW1zID0gKCkgPT4gaXRlbXM7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXROYW1lLFxuICAgICAgICBhZGRJdGVtLFxuICAgICAgICByZW1vdmVJdGVtLFxuICAgICAgICB0b2dnbGVEb25lLFxuICAgICAgICBnZXRJdGVtcyxcbiAgICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBDYXRlZ29yeTsiXSwibmFtZXMiOlsiX2V2ZW50cyIsImNoZWNrRXZlbnQiLCJldmVudE5hbWUiLCJldmVudCIsImZpbmQiLCJnZXROYW1lIiwibmFtZSIsImhhbmRsZXJzIiwiYWRkSGFuZGxlciIsImhhbmRsZXIiLCJwdXNoIiwiaW52b2tlSGFuZGxlcnMiLCJldmVudEFyZ3MiLCJmb3JFYWNoIiwiZm4iLCJfRXZlbnQiLCJwdWJsaXNoIiwic3Vic2NyaWJlIiwiVUkiLCJjcmVhdGVIdG1sRWxlbWVudCIsInR5cGUiLCJjbGFzc0FycmF5IiwiY29udGVudCIsImVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbHMiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImdldENhdGVnb3J5TmFtZSIsIiRlbGVtZW50IiwidmFsdWUiLCJzcGxpdCIsIiRjYXRlZ29yeUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCIkYWRkQ2F0ZWdvcnlCdG4iLCIkY2F0ZWdvcnlJbnB1dCIsIiRhY3RpdmVDYXRlZ29yeSIsImdldEVsZW1lbnRCeUlkIiwiJGN1cnJlbnRBY3RpdmUiLCJzZXRBY3RpdmUiLCIkY2F0ZWdvcnkiLCJyZW1vdmUiLCJjYXRlZ29yeU5hbWUiLCJhZGRDYXRlZ29yeURPTSIsImNhdGVnb3J5IiwiJG5ld0NhdGVnb3J5IiwiJGNhdCIsImFwcGVuZENoaWxkIiwiY2hpbGRFbGVtZW50Q291bnQiLCJuZXdDYXRlZ29yeSIsIiRkZWxldGVCdG4iLCJsYXN0Q2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInN0b3BQcm9wYWdhdGlvbiIsInJlbW92ZUNhdGVnb3J5RE9NIiwicGFyZW50Tm9kZSIsImFkZENhdGVnb3J5TGlzdGVuZXIiLCIkZmlyc3RDYXRlZ29yeSIsImZpcnN0RWxlbWVudENoaWxkIiwiJGl0ZW1Db250YWluZXIiLCIkYWRkSXRlbUJ0biIsInNob3dJdGVtcyIsIml0ZW1zIiwibWFwIiwiaXRlbSIsImFkZEl0ZW1ET00iLCIkbmV3SXRlbSIsIiRpdGVtIiwiJGNoZWNrQm94IiwiaXNEb25lIiwiY2hlY2tlZCIsIm5ld0l0ZW1ET00iLCJpdGVtRWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJjaGlsZHJlbiIsIml0ZW1Db250ZW50IiwiZWwiLCJjb250YWlucyIsInJlbW92ZUl0ZW1ET00iLCJ0b2dnbGVEb25lRE9NIiwiYWRkSXRlbUxpc3RlbmVyIiwiaW5pdCIsIiRpbnB1dCIsIiRva0J0biIsIiRjYW5jZWxCdG4iLCJzdHlsZSIsImRpc3BsYXkiLCJmb2N1cyIsIm9uY2UiLCJpbnB1dENhdGVnb3J5IiwiZmlyc3RDaGlsZCIsInByb21wdCIsImNhdGVnb3JpZXMiLCJnZXRDYXRlZ29yeSIsImNhdCIsImFkZENhdGVnb3J5IiwiYWxlcnQiLCJfZ2V0SXRlbSIsImFkZEl0ZW0iLCJJdGVtIiwicmVtb3ZlSXRlbSIsInVuZGVmaW5lZCIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInRvZ2dsZURvbmUiLCJnZXRJdGVtcyIsInJlbW92ZUNhdGVnb3J5Il0sInNvdXJjZVJvb3QiOiIifQ==